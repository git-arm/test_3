[{"id":"7a741de298788937","type":"tab","label":"Bokaro_dash_v1","disabled":false,"info":"","env":[]},{"id":"db3c2b79.2722b8","type":"subflow","name":"billet rejection condition","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"e5791bd7.39b8d8"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"dec31db0.dd919","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"dec31db0.dd919","port":1}]}],"env":[]},{"id":"538dd968.6eedf8","type":"subflow","name":"Subflow 1","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"bb973097.5c68"}]}],"out":[]},{"id":"6294eca.161f414","type":"subflow","name":"billet_reject_cond","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"18d0e15c.54684f"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"be18de69.1d61a","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"be18de69.1d61a","port":1}]}],"env":[]},{"id":"222db2d3.ec365e","type":"subflow","name":"billet rejection condition (2)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"151819a0.8bd8e6"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"1fdc8f0e.53f741","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"1fdc8f0e.53f741","port":1}]}],"env":[]},{"id":"3609fe58.bbdc52","type":"subflow","name":"Subflow 1 (2)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"5f961439.01a7cc"}]}],"out":[]},{"id":"1a4a07b7.574028","type":"subflow","name":"billet_reject_cond (2)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"7775f642.adce48"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"8bc59090.5bb26","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"8bc59090.5bb26","port":1}]}],"env":[]},{"id":"5c442765488e5b19","type":"subflow","name":"billet rejection condition (3)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"8c071a878bd814ea"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"023be18e43c043b5","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"023be18e43c043b5","port":1}]}],"env":[]},{"id":"0c1e55339cea51f3","type":"subflow","name":"Subflow 1 (3)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"1dd6e81d41ce7d45"}]}],"out":[]},{"id":"45833cf1d3c71670","type":"subflow","name":"billet_reject_cond (3)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"be4c43b53aeb9d80"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"6e89f5f31ab0a360","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"6e89f5f31ab0a360","port":1}]}],"env":[]},{"id":"c4f3e27a5e5c248d","type":"subflow","name":"billet rejection condition (2) (2)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"e3debb86af8c6648"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"04c189ca5ce9be80","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"04c189ca5ce9be80","port":1}]}],"env":[]},{"id":"5e1a4d45ae86e962","type":"subflow","name":"Subflow 1 (2) (2)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"64753ee16c207f86"}]}],"out":[]},{"id":"985d76ecef92726d","type":"subflow","name":"billet_reject_cond (2) (2)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"e9f0886447189de0"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"5928796cb2ad95fa","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"5928796cb2ad95fa","port":1}]}],"env":[]},{"id":"4815f06f0bdaa2aa","type":"subflow","name":"billet rejection condition (4)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"d5937796ed3e8469"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"8099b60c9b96360a","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"8099b60c9b96360a","port":1}]}],"env":[]},{"id":"c4345cacc986258a","type":"subflow","name":"Subflow 1 (4)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"ba3b97cd87c1aa39"}]}],"out":[]},{"id":"aa5d5df0e0c9a36a","type":"subflow","name":"billet_reject_cond (4)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"346a6dc3890d6c19"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"cec73053a4f6b1b2","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"cec73053a4f6b1b2","port":1}]}],"env":[]},{"id":"3e52703495c2ef6e","type":"subflow","name":"billet rejection condition (2) (3)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"7b9a915a3789e30c"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"32034a98e3c4ebb8","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"32034a98e3c4ebb8","port":1}]}],"env":[]},{"id":"143da1d1e758b61a","type":"subflow","name":"Subflow 1 (2) (3)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"a80ea6d0f147d657"}]}],"out":[]},{"id":"55e6f8a32ae8a43f","type":"subflow","name":"billet_reject_cond (2) (3)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"a31fc23af988d5e2"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"250d2cd60bf3500c","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"250d2cd60bf3500c","port":1}]}],"env":[]},{"id":"bc9baba03933e320","type":"subflow","name":"billet rejection condition (5)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"341d489e67c6a489"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"61516a36e0fb04bc","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"61516a36e0fb04bc","port":1}]}],"env":[]},{"id":"e190c5e0e2fe8b1f","type":"subflow","name":"Subflow 1 (5)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"e3c324670419a876"}]}],"out":[]},{"id":"fb0d740ca7477861","type":"subflow","name":"billet_reject_cond (5)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"e29cc2971598a000"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"706efe3428ac160e","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"706efe3428ac160e","port":1}]}],"env":[]},{"id":"14ccc85c3b36cdc2","type":"subflow","name":"billet rejection condition (2) (4)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"f85e89fd72c08f91"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"6c91829f58f4b11a","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"6c91829f58f4b11a","port":1}]}],"env":[]},{"id":"7b8cb491513bc759","type":"subflow","name":"Subflow 1 (2) (4)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"fc57f51cf61491f7"}]}],"out":[]},{"id":"06eafb1bf239d14b","type":"subflow","name":"billet_reject_cond (2) (4)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"b739c83e9f517b81"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"53211cf94f1bc1c4","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"53211cf94f1bc1c4","port":1}]}],"env":[]},{"id":"8e930ef98316b18a","type":"subflow","name":"billet rejection condition (6)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"2204162ab3c163a2"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"8d9ae703f31af423","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"8d9ae703f31af423","port":1}]}],"env":[]},{"id":"a2b3c04cacba73be","type":"subflow","name":"Subflow 1 (6)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"f495262b48df9342"}]}],"out":[]},{"id":"47054b48c745842f","type":"subflow","name":"billet_reject_cond (6)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"0179ec9d46457985"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"d6e15990941f92ce","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"d6e15990941f92ce","port":1}]}],"env":[]},{"id":"ca5c8c58f09fc994","type":"subflow","name":"billet rejection condition (2) (5)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"2d8b12e467b24280"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"644adab7b038c5fe","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"644adab7b038c5fe","port":1}]}],"env":[]},{"id":"08956b84de3f9840","type":"subflow","name":"Subflow 1 (2) (5)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"34841a18556a694f"}]}],"out":[]},{"id":"c7f909d74e51a5c2","type":"subflow","name":"billet_reject_cond (2) (5)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"82c060222b0f98fe"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"db23184aa0d0bc30","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"db23184aa0d0bc30","port":1}]}],"env":[]},{"id":"5338ce25c222e2fe","type":"subflow","name":"billet rejection condition (3) (2)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"907c7eef2f178ee5"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"f5c0bab2b6f69e83","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"f5c0bab2b6f69e83","port":1}]}],"env":[]},{"id":"e8f1bceec0096530","type":"subflow","name":"Subflow 1 (3) (2)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"e4dc3ddf116e0821"}]}],"out":[]},{"id":"99779fdb10bd0ee2","type":"subflow","name":"billet_reject_cond (3) (2)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"dd32cef9da5b6688"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"d9f82c932e5d0d7b","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"d9f82c932e5d0d7b","port":1}]}],"env":[]},{"id":"58ac689525e45831","type":"subflow","name":"billet rejection condition (2) (2) (2)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"2d23ae39ecf2d27e"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"8d93ec6c014873e8","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"8d93ec6c014873e8","port":1}]}],"env":[]},{"id":"c7238ca9e13327de","type":"subflow","name":"Subflow 1 (2) (2) (2)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"4b7c8946bcbc0a5a"}]}],"out":[]},{"id":"23960be9f58b3aca","type":"subflow","name":"billet_reject_cond (2) (2) (2)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"7c5a41795bd58c2e"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"19fb78fa01e9a3b4","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"19fb78fa01e9a3b4","port":1}]}],"env":[]},{"id":"3da456f25e6d6d22","type":"subflow","name":"billet rejection condition (4) (2)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"6a66eac3f01c6012"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"1b70592ad1c48f60","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"1b70592ad1c48f60","port":1}]}],"env":[]},{"id":"b3f6fa9ec3cfb3bf","type":"subflow","name":"Subflow 1 (4) (2)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"12f7e242dc9c70cb"}]}],"out":[]},{"id":"3af53d1b72d804b3","type":"subflow","name":"billet_reject_cond (4) (2)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"96ccd40d0ee49605"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"f07bd469dfaf8d87","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"f07bd469dfaf8d87","port":1}]}],"env":[]},{"id":"b72e495677058f03","type":"subflow","name":"billet rejection condition (2) (3) (2)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"3fac95f4b96b5b1e"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"86217775131edf7a","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"86217775131edf7a","port":1}]}],"env":[]},{"id":"e1e1bd53b5ba992f","type":"subflow","name":"Subflow 1 (2) (3) (2)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"f08ef7ac15c3d76d"}]}],"out":[]},{"id":"27060a2b2477c9fb","type":"subflow","name":"billet_reject_cond (2) (3) (2)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"75e8da9920a33caf"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"c3f0375ef8fc8e07","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"c3f0375ef8fc8e07","port":1}]}],"env":[]},{"id":"f8c4a4b5fdbe8bbc","type":"subflow","name":"billet rejection condition (5) (2)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"f3b6b7d9cb38caa0"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"81e2eb0de6d883e0","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"81e2eb0de6d883e0","port":1}]}],"env":[]},{"id":"79fd9d04e0aa31c8","type":"subflow","name":"Subflow 1 (5) (2)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"bd7a07ee1efd1322"}]}],"out":[]},{"id":"fe49b8da9b7e2783","type":"subflow","name":"billet_reject_cond (5) (2)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"7cfc55eba058f3d2"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"b54bb6aa1bf7467a","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"b54bb6aa1bf7467a","port":1}]}],"env":[]},{"id":"c74804fddfd5949e","type":"subflow","name":"billet rejection condition (2) (4) (2)","info":"","category":"","in":[{"x":35.00000190734863,"y":97,"wires":[{"id":"5b598e6256abe3de"}]}],"out":[{"x":1157.9999923706055,"y":437.0000867843628,"wires":[{"id":"b3cfadadc50a8e37","port":0}]},{"x":1150.999994277954,"y":498.00000762939453,"wires":[{"id":"b3cfadadc50a8e37","port":1}]}],"env":[]},{"id":"9d3c77214e0380da","type":"subflow","name":"Subflow 1 (2) (4) (2)","info":"","in":[{"x":87.99999809265137,"y":409.99999046325684,"wires":[{"id":"d3579b011ce11c8a"}]}],"out":[]},{"id":"5f5cde7a7d907be0","type":"subflow","name":"billet_reject_cond (2) (4) (2)","info":"","category":"","in":[{"x":50,"y":30,"wires":[{"id":"72142f7ebd3632c9"}]}],"out":[{"x":1155.9999647140503,"y":552.000020980835,"wires":[{"id":"dfda36a73de36bd3","port":0}]},{"x":1164.9999952316284,"y":619.000036239624,"wires":[{"id":"dfda36a73de36bd3","port":1}]}],"env":[]},{"id":"ead3ceda12a2434c","type":"subflow","name":"##rejection condition for excess billet weight##","info":"","category":"","in":[{"x":105.00000190734863,"y":45.99999809265137,"wires":[{"id":"e4e6fafb6738d167"}]}],"out":[{"x":1105.0000286102295,"y":490.99999046325684,"wires":[{"id":"a393cc1d3199c6dd","port":0}]},{"x":1105.0000591278076,"y":543.9999828338623,"wires":[{"id":"a393cc1d3199c6dd","port":1}]}],"env":[],"meta":{},"color":"#3FADB5","icon":"node-red/hash.svg"},{"id":"385741c070db5d8f","type":"mqtt-broker","name":"new","broker":"au7utqhqmvfpr-ats.iot.ap-south-1.amazonaws.com","port":"8883","tls":"ede00158d5047896","clientid":"","autoConnect":true,"usetls":true,"protocolVersion":"4","keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","birthMsg":{},"closeTopic":"","closeQos":"0","closePayload":"","closeMsg":{},"willTopic":"","willQos":"0","willPayload":"","willMsg":{},"sessionExpiry":""},{"id":"ede00158d5047896","type":"tls-config","name":"test_v1","cert":"","key":"","ca":"","certname":"d5766f7f337f9be50d493f86e6ab65222eee2ec292db25887eae57affe1b814e-certificate.pem.crt","keyname":"d5766f7f337f9be50d493f86e6ab65222eee2ec292db25887eae57affe1b814e-private.pem.key","caname":"AmazonRootCA1.pem","servername":"","verifyservercert":true,"alpnprotocol":""},{"id":"4259e3ed3b900ca3","type":"sqlitedb","db":"C:\\Users\\user\\Downloads\\sqlite\\test_sqlite_v1.db","mode":"RWC"},{"id":"3efadbde.42b454","type":"postgresdb","cfgname":"","hostname":"127.0.0.1","port":"5432","db":"jspl_wrm","ssl":false},{"id":"68c4c56.f65a43c","type":"postgresdb","cfgname":"","hostname":"localhost","port":"5432","db":"postgres","ssl":false},{"id":"9e2bd2d4.91215","type":"postgresdb","cfgname":"pg","hostname":"127.0.0.1","port":"3306","db":"jspl_wrm","ssl":false},{"id":"d714704c.7c05a","type":"MySQLdatabase","name":"","host":"127.0.0.1","port":"3306","db":"jspl_wrm","tz":"","charset":"UTF8"},{"id":"11e26ae6.9dfd55","type":"ui_base","theme":{"name":"theme-light","lightTheme":{"default":"#0094CE","baseColor":"#07744a","baseFont":"Verdana,Verdana,Geneva,sans-serif","edited":true,"reset":false},"darkTheme":{"default":"#097479","baseColor":"#097479","baseFont":"Trebuchet MS,Helvetica,sans-serif","edited":true,"reset":false},"customTheme":{"name":"Untitled Theme 1","default":"#4B7930","baseColor":"#4B7930","baseFont":"-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"},"themeState":{"base-color":{"default":"#0094CE","value":"#07744a","edited":true},"page-titlebar-backgroundColor":{"value":"#07744a","edited":false},"page-backgroundColor":{"value":"#fafafa","edited":false},"page-sidebar-backgroundColor":{"value":"#333333","edited":false},"group-textColor":{"value":"#0bbc78","edited":false},"group-borderColor":{"value":"#ffffff","edited":false},"group-backgroundColor":{"value":"#ffffff","edited":false},"widget-textColor":{"value":"#111111","edited":false},"widget-backgroundColor":{"value":"#07744a","edited":false},"widget-borderColor":{"value":"#ffffff","edited":false},"base-font":{"value":"Verdana,Verdana,Geneva,sans-serif"}},"angularTheme":{"primary":"indigo","accents":"blue","warn":"red","background":"grey","palette":"light"}},"site":{"name":"Node-RED Dashboard","hideToolbar":"false","allowSwipe":"true","lockMenu":"false","allowTempTheme":"true","dateFormat":"DD/MM/YYYY","sizes":{"sx":48,"sy":48,"gx":6,"gy":6,"cx":6,"cy":6,"px":0,"py":0}}},{"id":"95ee43b3.b5cd3","type":"ui_tab","name":"Home","icon":"dashboard","order":2,"disabled":false,"hidden":false},{"id":"279567d4.d8bf38","type":"ui_tab","name":"Tab 2","icon":"dashboard","order":3},{"id":"fb70545f.eecaa8","type":"ui_tab","name":"[Vega-Lite] Line & Bar Chart","icon":"dashboard","order":4,"disabled":false,"hidden":false},{"id":"ec560e144cd3fab4","type":"ui_tab","name":"Controller Calibration","icon":"dashboard","order":5,"disabled":false,"hidden":false},{"id":"24301019.1f614","type":"ui_tab","name":"Home","icon":"home","order":6},{"id":"60b1df13.5d4ea","type":"ui_group","name":"Weight range","tab":"3659c51e7aca61fe","order":12,"disp":true,"width":"6","collapse":false,"className":""},{"id":"41ae1eceb1583ca6","type":"ui_group","name":"config table","tab":"3c94630c.13381c","order":1,"disp":true,"width":"6","collapse":false,"className":""},{"id":"9f29b72e1d3672d8","type":"ui_group","name":"Last 5 calibration data","tab":"3659c51e7aca61fe","order":11,"disp":true,"width":"45","collapse":false,"className":""},{"id":"e3364ae6.46a5f8","type":"ui_group","name":"Group 1","tab":"fb70545f.eecaa8","order":1,"disp":false,"width":"10","collapse":false},{"id":"31148c4493d33b3b","type":"ui_group","name":"Billet weight","tab":"58c2aa06.ef46e4","order":2,"disp":true,"width":"6","collapse":false,"className":""},{"id":"9c301fce9d4d7f8c","type":"ui_group","name":"Calibration Weight input (kg)","tab":"3659c51e7aca61fe","order":4,"disp":true,"width":6,"collapse":false,"className":""},{"id":"5d3c4a83925aa0d8","type":"ui_group","name":"Calibrated count value ","tab":"3659c51e7aca61fe","order":5,"disp":true,"width":6,"collapse":false,"className":""},{"id":"1ea670bb2aad86ee","type":"ui_group","name":"Calibration","tab":"ec560e144cd3fab4","order":4,"disp":true,"width":"5","collapse":false},{"id":"e918872fbf744a7e","type":"ui_group","name":"Calibration range selection","tab":"ec560e144cd3fab4","order":5,"disp":true,"width":"6","collapse":false},{"id":"4714bc1cd10ae0d7","type":"ui_group","name":"Count value from PLC","tab":"ec560e144cd3fab4","order":1,"disp":true,"width":"6","collapse":false},{"id":"e50fb7dcc4f7ffe8","type":"ui_group","name":"Enable","tab":"3659c51e7aca61fe","order":7,"disp":true,"width":"4","collapse":false,"className":""},{"id":"1e439a94a3ad7db4","type":"ui_group","name":"Calibration options","tab":"3659c51e7aca61fe","order":8,"disp":true,"width":"6","collapse":true,"className":""},{"id":"6d01ec93.b1d374","type":"ui_group","name":"UserEntry","tab":"24301019.1f614","order":1,"disp":true,"width":"6","collapse":false},{"id":"4510203f.79061","type":"ui_group","name":"dialog","tab":"24301019.1f614","order":3,"disp":false,"width":"1","collapse":false},{"id":"4cf1fd02.47b284","type":"modbus-client","name":"display","clienttype":"serial","bufferCommands":true,"stateLogEnabled":false,"queueLogEnabled":false,"tcpHost":"127.0.0.1","tcpPort":"502","tcpType":"DEFAULT","serialPort":"COM3","serialType":"RTU","serialBaudrate":"9600","serialDatabits":"8","serialStopbits":"1","serialParity":"none","serialConnectionDelay":"10","serialAsciiResponseStartDelimiter":"","unit_id":"2","commandDelay":"1","clientTimeout":"100","reconnectOnTimeout":true,"reconnectTimeout":"2000","parallelUnitIdsAllowed":true},{"id":"381c64ca.e79efc","type":"s7 endpoint","transport":"iso-on-tcp","address":"192.168.0.2","port":"102","rack":"0","slot":"1","localtsaphi":"01","localtsaplo":"00","remotetsaphi":"01","remotetsaplo":"00","connmode":"rack-slot","adapter":"","busaddr":"2","cycletime":"1000","timeout":"2000","name":"","vartable":[{"addr":"I0.0","name":"PROXY_1200"},{"addr":"DB1,REAL4","name":"WEIGHT_1200"}]},{"id":"08d129507f33a291","type":"s7 endpoint","d":true,"transport":"iso-on-tcp","address":"","port":"102","rack":"0","slot":"2","localtsaphi":"01","localtsaplo":"00","remotetsaphi":"01","remotetsaplo":"00","connmode":"rack-slot","adapter":"","busaddr":"2","cycletime":"1000","timeout":"2000","name":"","vartable":[{"addr":"","name":""}]},{"id":"667aabcd786825b7","type":"s7 endpoint","transport":"iso-on-tcp","address":"192.168.0.2","port":"102","rack":"0","slot":"2","localtsaphi":"01","localtsaplo":"00","remotetsaphi":"01","remotetsaplo":"00","connmode":"rack-slot","adapter":"","busaddr":"2","cycletime":"1000","timeout":"2000","name":"","vartable":[{"addr":"DB1,REAL8","name":"count_number"}]},{"id":"045b35c0f1b9ccd4","type":"s7 endpoint","transport":"iso-on-tcp","address":"192.168.0.2","port":"102","rack":"0","slot":"1","localtsaphi":"01","localtsaplo":"00","remotetsaphi":"01","remotetsaplo":"00","connmode":"rack-slot","adapter":"","busaddr":"2","cycletime":"1000","timeout":"2000","name":"","vartable":[{"addr":"DB1,INT22","name":"x1"},{"addr":"DB1,INT28","name":"x2"},{"addr":"DB1,INT34","name":"x3"},{"addr":"DB1,INT24","name":"w1"},{"addr":"DB1,INT30","name":"w2"},{"addr":"DB1,INT36","name":"w3"},{"addr":"DB1,REAL44","name":"final_weight"},{"addr":"IW64","name":"count"},{"addr":"DB1,X20.1","name":"en1"},{"addr":"DB1,X26.0","name":"en2"},{"addr":"DB1,X32.0","name":"en3"},{"addr":"DB1,INT40","name":"x4"},{"addr":"DB1,INT42","name":"w4"},{"addr":"DB1,X38.0","name":"en4"},{"addr":"DB1,INT48","name":"count_up"},{"addr":"DB1,INT50","name":"count_down"},{"addr":"DB2,INT3","name":"Count_value"},{"addr":"IW64","name":"COUNT_A"},{"addr":"DB1,REAL4","name":"Billet_weight"},{"addr":"I0.0","name":"Proxy_1200"}]},{"id":"f35f8f4477ff37d7","type":"postgresdb","cfgname":"","hostname":"127.0.0.1","port":"5432","db":"jspl_wrm","ssl":false},{"id":"916af0b6893dfe76","type":"s7 endpoint","transport":"iso-on-tcp","address":"192.168.0.107","port":"102","rack":"0","slot":"1","localtsaphi":"01","localtsaplo":"00","remotetsaphi":"01","remotetsaplo":"00","connmode":"rack-slot","adapter":"","busaddr":"2","cycletime":"1000","timeout":"2000","name":"","vartable":[{"addr":"M0.1","name":"PROXY_COUNT"},{"addr":"IW64","name":"COUNT_PLC"},{"addr":"DB1,X20.1","name":"SCALE_EN_1"},{"addr":"DB1,INT22","name":"SCALE_COUNT_1"},{"addr":"DB1,REAL24","name":"SCALE_WT_1"},{"addr":"DB1,X28.0","name":"SCALE_EN_2"},{"addr":"DB1,INT30","name":"SCALE_COUNT_2"},{"addr":"DB1,REAL32","name":"SCALE_WT_2"},{"addr":"DB1,X36.0","name":"SCALE_EN_3"},{"addr":"DB1,INT38","name":"SCALE_COUNT_3"},{"addr":"DB1,REAL40","name":"SCALE_WT_3"},{"addr":"DB1,X44.0","name":"SCALE_EN_4"},{"addr":"DB1,INT46","name":"SCALE_COUNT_4"},{"addr":"DB1,REAL48","name":"SCALE_WT_4"},{"addr":"DB1,REAL52","name":"FINAL_WT"},{"addr":"Q0.0","name":"proxy_in"},{"addr":"DB1,INT56","name":"Proxy_CV"},{"addr":"DB1,REAL4","name":"Scaled_out"},{"addr":"DB1,X58.0","name":"Reset_CTU"},{"addr":"I0.0","name":"PROXY_1200"},{"addr":"DB1,INT60","name":"PLC_START"}]},{"id":"3a12ef9bd3ab91e3","type":"ui_group","name":"Proxy count","tab":"3659c51e7aca61fe","order":9,"disp":true,"width":"6","collapse":true,"className":""},{"id":"0fad27764e1eea84","type":"s7 endpoint","transport":"iso-on-tcp","address":"192.168.0.103","port":"102","rack":"0","slot":"1","localtsaphi":"01","localtsaplo":"00","remotetsaphi":"01","remotetsaplo":"00","connmode":"rack-slot","adapter":"","busaddr":"2","cycletime":"1000","timeout":"2000","name":"","vartable":[{"addr":"DB1,INT52","name":"PLC_START"},{"addr":"DB1,INT54","name":"PLC_STOP"}]},{"id":"61d2dced.3db8f4","type":"ui_group","name":"flowtest","tab":"3c94630c.13381c","order":1,"disp":true,"width":"12","collapse":false},{"id":"3c94630c.13381c","type":"ui_tab","name":"Test","icon":"dashboard","order":7,"disabled":false,"hidden":false},{"id":"6209999e.5b1f8","type":"ui_group","name":"dropdwn_1","tab":"3c94630c.13381c","order":2,"disp":true,"width":"6","collapse":true,"className":""},{"id":"d1033a1a0978d4ac","type":"MySQLdatabase","name":"bokaro","host":"localhost","port":"3306","db":"bokaro_test","tz":"","charset":"UTF8"},{"id":"3659c51e7aca61fe","type":"ui_tab","name":"Controller calibration v2","icon":"dashboard","order":1,"disabled":false,"hidden":false},{"id":"8f3f27758d55df54","type":"ui_group","name":"counter","tab":"a1256b95c8851d51","order":1,"disp":true,"width":"4","collapse":false,"className":""},{"id":"e9a85b25dc5eeee3","type":"ui_group","name":"Accept data","tab":"3659c51e7aca61fe","order":6,"disp":true,"width":"3","collapse":false,"className":""},{"id":"547c2cd04a6e2d1d","type":"ui_group","name":"Weight test (kg)","tab":"3659c51e7aca61fe","order":2,"disp":true,"width":"4","collapse":false,"className":""},{"id":"801b12024a335ebd","type":"ui_group","name":"Current Calibration Data","tab":"3659c51e7aca61fe","order":10,"disp":true,"width":"45","collapse":false,"className":""},{"id":"fe9b4de4.dcd72","type":"ui_group","name":"Name list","tab":"da612906.998368","order":1,"disp":true,"width":"15","collapse":false},{"id":"da612906.998368","type":"ui_tab","name":"Main-PC","icon":"dashboard","order":8,"disabled":false,"hidden":false},{"id":"dc6468b68be36011","type":"ui_group","name":"Default","tab":"95ee43b3.b5cd3","order":2,"disp":true,"width":"6","collapse":false,"className":""},{"id":"625872f.40b1e8c","type":"ui_group","name":"Default","tab":"58c2aa06.ef46e4","order":1,"disp":true,"width":"6","collapse":false},{"id":"58c2aa06.ef46e4","type":"ui_tab","name":"Home","icon":"dashboard","order":9,"disabled":false,"hidden":false},{"id":"13b35473.20565c","type":"ui_group","name":"Default","tab":"de4df751.046f08","order":3,"disp":false,"width":"6","collapse":false},{"id":"de4df751.046f08","type":"ui_tab","name":"Home","icon":"track_changes","order":10,"disabled":false,"hidden":false},{"id":"42ceb1ec.be218","type":"ui_group","name":"Inputs","tab":"e6a82a1a.24db38","order":1,"disp":false,"width":"6","collapse":false},{"id":"e6a82a1a.24db38","type":"ui_tab","name":"Bobby","icon":"child","order":11,"disabled":false,"hidden":false},{"id":"42f6f7b2d435320e","type":"ui_group","name":"filtered weight","tab":"3659c51e7aca61fe","order":3,"disp":true,"width":"20","collapse":false,"className":""},{"id":"e717f815c7f2a208","type":"ui_tab","name":"weight filter test","icon":"dashboard","disabled":false,"hidden":false},{"id":"58706027defa7777","type":"ui_group","name":"weight_filter_test","tab":"e717f815c7f2a208","order":1,"disp":true,"width":"9","collapse":false,"className":""},{"id":"608e41876c4bcb14","type":"ui_tab","name":"Home","icon":"dashboard","disabled":false,"hidden":false},{"id":"be7f8d7288d378f6","type":"ui_group","name":"array size","tab":"e717f815c7f2a208","order":2,"disp":true,"width":"6","collapse":false,"className":""},{"id":"a1256b95c8851d51","type":"ui_tab","name":"Usha Martin","icon":"dashboard","disabled":false,"hidden":false},{"id":"4125cbee4eb8a0e6","type":"ui_group","name":"Machine Speed","tab":"a1256b95c8851d51","order":2,"disp":true,"width":"6","collapse":false,"className":""},{"id":"30442433d25f5afc","type":"ui_group","name":"Runtime","tab":"a1256b95c8851d51","order":3,"disp":true,"width":"6","collapse":false,"className":""},{"id":"047175c1b9b357d9","type":"ui_group","name":"Stoptime","tab":"a1256b95c8851d51","order":4,"disp":true,"width":"6","collapse":false,"className":""},{"id":"f66084de8463468b","type":"ui_group","name":"Production","tab":"a1256b95c8851d51","order":5,"disp":true,"width":"6","collapse":false,"className":""},{"id":"8ae1befafc992efa","type":"ui_group","name":"Select Machine","tab":"a1256b95c8851d51","order":1,"disp":true,"width":"6","collapse":false,"className":""},{"id":"0d038cd22b659176","type":"ui_group","name":"Run/Stop time","tab":"a1256b95c8851d51","order":6,"disp":true,"width":"6","collapse":false,"className":""},{"id":"d628f07ebe11bec7","type":"ui_group","name":"Speed Trend","tab":"a1256b95c8851d51","order":7,"disp":true,"width":"23","collapse":false,"className":""},{"id":"a050522dfb976e18","type":"ui_group","name":"production trend","tab":"a1256b95c8851d51","order":9,"disp":true,"width":"6","collapse":false,"className":""},{"id":"a7c5c4529651f4cd","type":"ui_group","name":"production Trend bar","tab":"a1256b95c8851d51","order":10,"disp":true,"width":"6","collapse":false,"className":""},{"id":"608298b1d88b325e","type":"mpi-s7 adapter","name":"","timeout":"10005","adapter":"usb","busconfigmode":"s7-300/400","busaddr":"4","maxbusaddr":"19","busspeed":"BAUD_9k6","busparams":""},{"id":"22f559bb18fbc1db","type":"mpi-s7 adapter","name":"8422_1","timeout":"10000","adapter":"","busconfigmode":"s7-300/400","busaddr":"3","maxbusaddr":"31","busspeed":"BAUD_187k5","busparams":""},{"id":"fbf4a7ba81e390c6","type":"mpi-s7 adapter","name":"","timeout":"10000","adapter":"","busconfigmode":"s7-300/400","busaddr":"2","maxbusaddr":"31","busspeed":"BAUD_AUTO","busparams":""},{"id":"a01f14f30a3b4f41","type":"mpi-s7 adapter","name":"lrpc_v1","timeout":"10000","adapter":"","busconfigmode":"s7-300/400","busaddr":"2","maxbusaddr":"31","busspeed":"BAUD_AUTO","busparams":""},{"id":"91b8c5a1f8d471c6","type":"google-service-account","name":"Bokaro_v1","scope":["service-account-v1@nrtocloud.iam.gserviceaccount.com"],"way":"json","check_dialogflow":"","check_speech":""},{"id":"19dc9349.57f72d","type":"ui_group","name":"Google sheets","tab":"5423d9a1.87d8b8","order":1,"disp":true,"width":"6","collapse":false},{"id":"e6548b0f.6183a8","type":"google-service-account","name":"myproject_1","scope":["https://www.googleapis.com/auth/spreadsheets"],"way":"json","check_dialogflow":"","check_speech":""},{"id":"5423d9a1.87d8b8","type":"ui_tab","name":"Submit form to google sheets","icon":"dashboard","disabled":false,"hidden":false},{"id":"62b326f1ae710f47","type":"gauth","name":"service-account-v1@nrtocloud.iam.gserviceaccount.com"},{"id":"e6727095dfd882ac","type":"s7 endpoint","d":true,"transport":"iso-on-tcp","address":"","port":"102","rack":"0","slot":"2","localtsaphi":"01","localtsaplo":"00","remotetsaphi":"01","remotetsaplo":"00","connmode":"rack-slot","adapter":"","busaddr":"2","cycletime":"1000","timeout":"2000","name":"","vartable":[{"addr":"","name":""}]},{"id":"6402b2b5ac00aeee","type":"modbus-client","name":"Selec_MFM","clienttype":"simpleser","bufferCommands":true,"stateLogEnabled":false,"queueLogEnabled":false,"tcpHost":"127.0.0.1","tcpPort":"502","tcpType":"DEFAULT","serialPort":"COM3","serialType":"RTU","serialBaudrate":"9600","serialDatabits":"8","serialStopbits":"1","serialParity":"none","serialConnectionDelay":"100","serialAsciiResponseStartDelimiter":"0x3A","unit_id":"91","commandDelay":"1","clientTimeout":"1000","reconnectOnTimeout":true,"reconnectTimeout":"2000","parallelUnitIdsAllowed":true},{"id":"7d483369ef5a6b71","type":"modbus-client","name":"selec_mfm_v2","clienttype":"simpleser","bufferCommands":true,"stateLogEnabled":false,"queueLogEnabled":false,"tcpHost":"127.0.0.1","tcpPort":"502","tcpType":"DEFAULT","serialPort":"COM3","serialType":"RTU","serialBaudrate":"9600","serialDatabits":"8","serialStopbits":"2","serialParity":"none","serialConnectionDelay":"10","serialAsciiResponseStartDelimiter":"0x3A","unit_id":"1","commandDelay":"1","clientTimeout":"1000","reconnectOnTimeout":true,"reconnectTimeout":"1000","parallelUnitIdsAllowed":true},{"id":"3609b94fd8a24753","type":"modbus-client","name":"mfm_modbus_v3_working","clienttype":"serial","bufferCommands":true,"stateLogEnabled":false,"queueLogEnabled":false,"tcpHost":"127.0.0.1","tcpPort":"502","tcpType":"DEFAULT","serialPort":"COM4","serialType":"RTU-BUFFERD","serialBaudrate":"9600","serialDatabits":"8","serialStopbits":"1","serialParity":"none","serialConnectionDelay":"1000","serialAsciiResponseStartDelimiter":"0x3A","unit_id":"134","commandDelay":"1","clientTimeout":"100","reconnectOnTimeout":true,"reconnectTimeout":"2000","parallelUnitIdsAllowed":false},{"id":"424c1d4a1b9612c7","type":"modbus-client","name":"MFM_modbus_v4","clienttype":"serial","bufferCommands":true,"stateLogEnabled":false,"queueLogEnabled":false,"tcpHost":"127.0.0.1","tcpPort":"502","tcpType":"DEFAULT","serialPort":"COM4","serialType":"RTU-BUFFERD","serialBaudrate":"9600","serialDatabits":"8","serialStopbits":"1","serialParity":"none","serialConnectionDelay":"100","serialAsciiResponseStartDelimiter":"0x3A","unit_id":"1","commandDelay":"1","clientTimeout":"1000","reconnectOnTimeout":false,"reconnectTimeout":"2000","parallelUnitIdsAllowed":true},{"id":"3241f12276ed7a93","type":"gauth","name":"armatricstesting@assignmentv1.iam.gserviceaccount.com"},{"id":"1b3e5d6236a2135d","type":"ui_tab","name":"Bokaro_v1","icon":"dashboard","disabled":false,"hidden":false},{"id":"a880e19b0244cdce","type":"ui_group","name":"Voltage_recent","tab":"1b3e5d6236a2135d","order":1,"disp":true,"width":"6","collapse":false,"className":""},{"id":"4dab2ad53c5837f1","type":"google-service-account","name":"Bokaro_1","scope":[],"way":"json","check_dialogflow":"","check_speech":""},{"id":"da1c3071a6b03444","type":"google-service-account","name":"bokaro_1","scope":[],"way":"json","check_dialogflow":"","check_speech":""},{"id":"f639f2f1e5f2fb6d","type":"ui_spacer","z":"7a741de298788937","name":"spacer","group":"8f3f27758d55df54","order":2,"width":1,"height":1},{"id":"f4e422e8b0a1d5b9","type":"MySQLdatabase","name":"shibnath_database","host":"sql6.freesqldatabase.com","port":"3306","db":"sql6514334","tz":"","charset":"UTF8"},{"id":"8b817adf2b651a8e","type":"MySQLdatabase","name":"","host":"armatricsdb.mysql.database.azure.com","port":"3306","db":"energy","tz":"","charset":"UTF8"},{"id":"f310dbc6faf62152","type":"tedious-connection","server":"armatrics.database.windows.net","username":"testdatabase"},{"id":"f5fe75e7fa835080","type":"MySQLdatabase","name":"","host":"server491829892.mysql.database.azure.com","port":"3306","db":"blsdatabase","tz":"","charset":"UTF8"},{"id":"e5791bd7.39b8d8","type":"function","z":"db3c2b79.2722b8","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"8508156b.f26b68","type":"change","z":"db3c2b79.2722b8","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["3af0b136.1a173e"]]},{"id":"4cd9745a.03bc7c","type":"function","z":"db3c2b79.2722b8","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"98f3fe21.54542","type":"change","z":"db3c2b79.2722b8","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["38a99cc8.d3a364"]]},{"id":"38a99cc8.d3a364","type":"function","z":"db3c2b79.2722b8","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["b2521736.984028"]]},{"id":"3af0b136.1a173e","type":"function","z":"db3c2b79.2722b8","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["4cd9745a.03bc7c","2e9a685a.57ee98"]]},{"id":"2e9a685a.57ee98","type":"function","z":"db3c2b79.2722b8","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"da928066.da901","type":"change","z":"db3c2b79.2722b8","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["88f4192a.e04058"]]},{"id":"88f4192a.e04058","type":"function","z":"db3c2b79.2722b8","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["b2521736.984028"]]},{"id":"e1502f66.8bee4","type":"function","z":"db3c2b79.2722b8","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["d4537085.245f8"]]},{"id":"b2521736.984028","type":"join","z":"db3c2b79.2722b8","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["e1502f66.8bee4"]]},{"id":"dec31db0.dd919","type":"switch","z":"db3c2b79.2722b8","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"d4537085.245f8","type":"function","z":"db3c2b79.2722b8","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["dec31db0.dd919"]]},{"id":"ee2d9c77.f0111","type":"function","z":"538dd968.6eedf8","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"6999c604.8d2418","type":"inject","z":"538dd968.6eedf8","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["ee2d9c77.f0111"]]},{"id":"fe282dea.9e9ee","type":"debug","z":"538dd968.6eedf8","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"dc6c123.1497df","type":"change","z":"538dd968.6eedf8","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"80200ee8.1d17a","type":"inject","z":"538dd968.6eedf8","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"703cb9fc.442518","type":"inject","z":"538dd968.6eedf8","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"bb973097.5c68","type":"subflow:db3c2b79.2722b8","z":"538dd968.6eedf8","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"c509601d.800fb","type":"inject","z":"538dd968.6eedf8","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"18d0e15c.54684f","type":"function","z":"6294eca.161f414","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"be76735d.1a502","type":"function","z":"6294eca.161f414","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"dde9a942.c3e388","type":"change","z":"6294eca.161f414","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["cd0e27a4.83f928"]]},{"id":"cd0e27a4.83f928","type":"function","z":"6294eca.161f414","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["591333f8.65046c","e3cf9c4b.4be01"]]},{"id":"6fc24efe.dbce6","type":"change","z":"6294eca.161f414","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["be76735d.1a502"]]},{"id":"591333f8.65046c","type":"function","z":"6294eca.161f414","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"c0f2b71f.bb0758","type":"change","z":"6294eca.161f414","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["6aa9fa1.0190904"]]},{"id":"6aa9fa1.0190904","type":"function","z":"6294eca.161f414","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["7225b4c2.71421c"]]},{"id":"e3cf9c4b.4be01","type":"function","z":"6294eca.161f414","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"6a938a2c.21dea4","type":"change","z":"6294eca.161f414","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["356c7987.95c406"]]},{"id":"356c7987.95c406","type":"function","z":"6294eca.161f414","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["7225b4c2.71421c"]]},{"id":"ea849cb4.ecabe","type":"function","z":"6294eca.161f414","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["36b1fff5.e334d"]]},{"id":"7225b4c2.71421c","type":"join","z":"6294eca.161f414","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["ea849cb4.ecabe"]]},{"id":"be18de69.1d61a","type":"switch","z":"6294eca.161f414","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"36b1fff5.e334d","type":"function","z":"6294eca.161f414","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["be18de69.1d61a"]]},{"id":"151819a0.8bd8e6","type":"function","z":"222db2d3.ec365e","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"736fa2af.f6112c","type":"change","z":"222db2d3.ec365e","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["a0d61a04.e280f8"]]},{"id":"c979415e.54195","type":"function","z":"222db2d3.ec365e","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"1c20ab08.d77045","type":"change","z":"222db2d3.ec365e","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["beb74be8.b09998"]]},{"id":"beb74be8.b09998","type":"function","z":"222db2d3.ec365e","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["ea4b3a8a.626808"]]},{"id":"a0d61a04.e280f8","type":"function","z":"222db2d3.ec365e","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["c979415e.54195","b5bc6358.04bee"]]},{"id":"b5bc6358.04bee","type":"function","z":"222db2d3.ec365e","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"33ff3671.6497ca","type":"change","z":"222db2d3.ec365e","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["dd819aa1.066148"]]},{"id":"dd819aa1.066148","type":"function","z":"222db2d3.ec365e","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["ea4b3a8a.626808"]]},{"id":"dc432464.9fbc48","type":"function","z":"222db2d3.ec365e","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["4f10f6db.b6fe38"]]},{"id":"ea4b3a8a.626808","type":"join","z":"222db2d3.ec365e","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["dc432464.9fbc48"]]},{"id":"1fdc8f0e.53f741","type":"switch","z":"222db2d3.ec365e","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"4f10f6db.b6fe38","type":"function","z":"222db2d3.ec365e","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["1fdc8f0e.53f741"]]},{"id":"e0823c2a.4b648","type":"function","z":"3609fe58.bbdc52","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"23cebdb9.fd1352","type":"inject","z":"3609fe58.bbdc52","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["e0823c2a.4b648"]]},{"id":"bf1cc63f.c705c8","type":"debug","z":"3609fe58.bbdc52","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"2f8d1427.d2604c","type":"change","z":"3609fe58.bbdc52","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"761dc9cd.a28958","type":"inject","z":"3609fe58.bbdc52","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"35bb62d9.216c5e","type":"inject","z":"3609fe58.bbdc52","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"5f961439.01a7cc","type":"subflow:222db2d3.ec365e","z":"3609fe58.bbdc52","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"7d05f42e.d4699c","type":"inject","z":"3609fe58.bbdc52","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"7775f642.adce48","type":"function","z":"1a4a07b7.574028","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"f3e9682f.3401e8","type":"function","z":"1a4a07b7.574028","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"594f4ae3.705be4","type":"change","z":"1a4a07b7.574028","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["63e7c7c3.707638"]]},{"id":"63e7c7c3.707638","type":"function","z":"1a4a07b7.574028","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["3a70dfe8.b47af","4c7c71e2.bec6d"]]},{"id":"aa600921.e6d288","type":"change","z":"1a4a07b7.574028","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["f3e9682f.3401e8"]]},{"id":"3a70dfe8.b47af","type":"function","z":"1a4a07b7.574028","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"f2eee906.c14048","type":"change","z":"1a4a07b7.574028","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["4f9767ee.2c0078"]]},{"id":"4f9767ee.2c0078","type":"function","z":"1a4a07b7.574028","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["3f37e59e.f372fa"]]},{"id":"4c7c71e2.bec6d","type":"function","z":"1a4a07b7.574028","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"90d3fa41.d0e0a8","type":"change","z":"1a4a07b7.574028","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["8f4881c7.793ff"]]},{"id":"8f4881c7.793ff","type":"function","z":"1a4a07b7.574028","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["3f37e59e.f372fa"]]},{"id":"32f603a.64f93fc","type":"function","z":"1a4a07b7.574028","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["1b91e15f.ac0a3f"]]},{"id":"3f37e59e.f372fa","type":"join","z":"1a4a07b7.574028","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["32f603a.64f93fc"]]},{"id":"8bc59090.5bb26","type":"switch","z":"1a4a07b7.574028","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"1b91e15f.ac0a3f","type":"function","z":"1a4a07b7.574028","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["8bc59090.5bb26"]]},{"id":"8c071a878bd814ea","type":"function","z":"5c442765488e5b19","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"27d3dbc04ec9deb5","type":"change","z":"5c442765488e5b19","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["fae0138caa61b9da"]]},{"id":"68de40b97ed62fe1","type":"function","z":"5c442765488e5b19","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"a7b00fbe7e24076c","type":"change","z":"5c442765488e5b19","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["633841b2a35f7730"]]},{"id":"633841b2a35f7730","type":"function","z":"5c442765488e5b19","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["c11cb68a843abd61"]]},{"id":"fae0138caa61b9da","type":"function","z":"5c442765488e5b19","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["68de40b97ed62fe1","9ffd99092ddb4ee0"]]},{"id":"9ffd99092ddb4ee0","type":"function","z":"5c442765488e5b19","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"c50398252c6eb678","type":"change","z":"5c442765488e5b19","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["8a2a6e52940b65c0"]]},{"id":"8a2a6e52940b65c0","type":"function","z":"5c442765488e5b19","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["c11cb68a843abd61"]]},{"id":"5f7dfb94089adabc","type":"function","z":"5c442765488e5b19","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["3041e848389725ae"]]},{"id":"c11cb68a843abd61","type":"join","z":"5c442765488e5b19","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["5f7dfb94089adabc"]]},{"id":"023be18e43c043b5","type":"switch","z":"5c442765488e5b19","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"3041e848389725ae","type":"function","z":"5c442765488e5b19","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["023be18e43c043b5"]]},{"id":"43cfa66fd96da0ba","type":"function","z":"0c1e55339cea51f3","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"89184db075a29f1c","type":"inject","z":"0c1e55339cea51f3","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["43cfa66fd96da0ba"]]},{"id":"6e59ace4300802ea","type":"debug","z":"0c1e55339cea51f3","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"ff932c1b237cd2db","type":"change","z":"0c1e55339cea51f3","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"2702760813b38a93","type":"inject","z":"0c1e55339cea51f3","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"d141dc051332a901","type":"inject","z":"0c1e55339cea51f3","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"1dd6e81d41ce7d45","type":"subflow:5c442765488e5b19","z":"0c1e55339cea51f3","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"9b598cd356b59e5c","type":"inject","z":"0c1e55339cea51f3","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"be4c43b53aeb9d80","type":"function","z":"45833cf1d3c71670","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"7a855214b50f30f0","type":"function","z":"45833cf1d3c71670","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"4bccb18c6454b255","type":"change","z":"45833cf1d3c71670","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["26fdf0b79a29c620"]]},{"id":"26fdf0b79a29c620","type":"function","z":"45833cf1d3c71670","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["ff690452ebaa7040","cc853c63a0904511"]]},{"id":"924fdf2ab8aeb7f4","type":"change","z":"45833cf1d3c71670","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["7a855214b50f30f0"]]},{"id":"ff690452ebaa7040","type":"function","z":"45833cf1d3c71670","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"4ced005df32b2275","type":"change","z":"45833cf1d3c71670","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["6a997e71ef9ea150"]]},{"id":"6a997e71ef9ea150","type":"function","z":"45833cf1d3c71670","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["fced372add761a76"]]},{"id":"cc853c63a0904511","type":"function","z":"45833cf1d3c71670","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"1eb8afc684533a05","type":"change","z":"45833cf1d3c71670","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["6907b7c004526fcb"]]},{"id":"6907b7c004526fcb","type":"function","z":"45833cf1d3c71670","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["fced372add761a76"]]},{"id":"a3e72a0c8164c8a7","type":"function","z":"45833cf1d3c71670","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["6a742553e97cc3cd"]]},{"id":"fced372add761a76","type":"join","z":"45833cf1d3c71670","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["a3e72a0c8164c8a7"]]},{"id":"6e89f5f31ab0a360","type":"switch","z":"45833cf1d3c71670","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"6a742553e97cc3cd","type":"function","z":"45833cf1d3c71670","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["6e89f5f31ab0a360"]]},{"id":"e3debb86af8c6648","type":"function","z":"c4f3e27a5e5c248d","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"90c30d134c8d974d","type":"change","z":"c4f3e27a5e5c248d","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["0ac2c09d742f18df"]]},{"id":"ec3fc55b19ad5a43","type":"function","z":"c4f3e27a5e5c248d","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"7d159c740a1e4ff5","type":"change","z":"c4f3e27a5e5c248d","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["fcdcf43acbb7db38"]]},{"id":"fcdcf43acbb7db38","type":"function","z":"c4f3e27a5e5c248d","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["1f6c20df12e49122"]]},{"id":"0ac2c09d742f18df","type":"function","z":"c4f3e27a5e5c248d","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["ec3fc55b19ad5a43","d2264729dafcc686"]]},{"id":"d2264729dafcc686","type":"function","z":"c4f3e27a5e5c248d","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"053134f05d4e131a","type":"change","z":"c4f3e27a5e5c248d","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["c07869631710b959"]]},{"id":"c07869631710b959","type":"function","z":"c4f3e27a5e5c248d","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["1f6c20df12e49122"]]},{"id":"eb616719886bd1fa","type":"function","z":"c4f3e27a5e5c248d","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["89dbaf0afcff065e"]]},{"id":"1f6c20df12e49122","type":"join","z":"c4f3e27a5e5c248d","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["eb616719886bd1fa"]]},{"id":"04c189ca5ce9be80","type":"switch","z":"c4f3e27a5e5c248d","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"89dbaf0afcff065e","type":"function","z":"c4f3e27a5e5c248d","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["04c189ca5ce9be80"]]},{"id":"f15d61140c9c28f6","type":"function","z":"5e1a4d45ae86e962","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"ebdc957affc988c9","type":"inject","z":"5e1a4d45ae86e962","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["f15d61140c9c28f6"]]},{"id":"26c4ee5a4543c6a3","type":"debug","z":"5e1a4d45ae86e962","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"b8e41d0af66e1dd4","type":"change","z":"5e1a4d45ae86e962","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"a77d86a499c1b873","type":"inject","z":"5e1a4d45ae86e962","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"5621b08ac3eeb9f0","type":"inject","z":"5e1a4d45ae86e962","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"64753ee16c207f86","type":"subflow:c4f3e27a5e5c248d","z":"5e1a4d45ae86e962","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"17b3b7f65af980a9","type":"inject","z":"5e1a4d45ae86e962","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"e9f0886447189de0","type":"function","z":"985d76ecef92726d","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"ba23591b3ef24262","type":"function","z":"985d76ecef92726d","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"85b64a5b5a93c4eb","type":"change","z":"985d76ecef92726d","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["7c59abcc4d9d5d06"]]},{"id":"7c59abcc4d9d5d06","type":"function","z":"985d76ecef92726d","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["416a4fcddb89308d","93c79bb0f85f1474"]]},{"id":"e95a8f1f2333a00e","type":"change","z":"985d76ecef92726d","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["ba23591b3ef24262"]]},{"id":"416a4fcddb89308d","type":"function","z":"985d76ecef92726d","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"7bff4d84572362e0","type":"change","z":"985d76ecef92726d","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["801922dd0b4b6eb5"]]},{"id":"801922dd0b4b6eb5","type":"function","z":"985d76ecef92726d","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["22fada625054ab06"]]},{"id":"93c79bb0f85f1474","type":"function","z":"985d76ecef92726d","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"db62fe1ba84da826","type":"change","z":"985d76ecef92726d","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["5793dc694205e66b"]]},{"id":"5793dc694205e66b","type":"function","z":"985d76ecef92726d","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["22fada625054ab06"]]},{"id":"8807e7da1a3dbca1","type":"function","z":"985d76ecef92726d","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["6534c599edf1fa12"]]},{"id":"22fada625054ab06","type":"join","z":"985d76ecef92726d","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["8807e7da1a3dbca1"]]},{"id":"5928796cb2ad95fa","type":"switch","z":"985d76ecef92726d","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"6534c599edf1fa12","type":"function","z":"985d76ecef92726d","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["5928796cb2ad95fa"]]},{"id":"d5937796ed3e8469","type":"function","z":"4815f06f0bdaa2aa","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"72c895776b7c7899","type":"change","z":"4815f06f0bdaa2aa","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["a3f7977830c856b2"]]},{"id":"2b4546a3d7f93ebf","type":"function","z":"4815f06f0bdaa2aa","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"d89bcbc283529cb4","type":"change","z":"4815f06f0bdaa2aa","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["7e7375d12b3cfbe1"]]},{"id":"7e7375d12b3cfbe1","type":"function","z":"4815f06f0bdaa2aa","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["1736e9cac2d15aa1"]]},{"id":"a3f7977830c856b2","type":"function","z":"4815f06f0bdaa2aa","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["2b4546a3d7f93ebf","18434cb0622bd4c2"]]},{"id":"18434cb0622bd4c2","type":"function","z":"4815f06f0bdaa2aa","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"6795a095ef25c859","type":"change","z":"4815f06f0bdaa2aa","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["b7f32be130d4dfa0"]]},{"id":"b7f32be130d4dfa0","type":"function","z":"4815f06f0bdaa2aa","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["1736e9cac2d15aa1"]]},{"id":"73d3c467e423ba4b","type":"function","z":"4815f06f0bdaa2aa","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["c16a6d51bb06e3e9"]]},{"id":"1736e9cac2d15aa1","type":"join","z":"4815f06f0bdaa2aa","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["73d3c467e423ba4b"]]},{"id":"8099b60c9b96360a","type":"switch","z":"4815f06f0bdaa2aa","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"c16a6d51bb06e3e9","type":"function","z":"4815f06f0bdaa2aa","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["8099b60c9b96360a"]]},{"id":"327550a9af25f45c","type":"function","z":"c4345cacc986258a","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"053fb4d0f3e65f32","type":"inject","z":"c4345cacc986258a","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["327550a9af25f45c"]]},{"id":"5f76ab5d06de7872","type":"debug","z":"c4345cacc986258a","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"975729c1a00771dd","type":"change","z":"c4345cacc986258a","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"f659d2c7161c2e33","type":"inject","z":"c4345cacc986258a","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"b4bf2d3c6a3b594f","type":"inject","z":"c4345cacc986258a","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"ba3b97cd87c1aa39","type":"subflow:4815f06f0bdaa2aa","z":"c4345cacc986258a","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"5815d1dad32ccce1","type":"inject","z":"c4345cacc986258a","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"346a6dc3890d6c19","type":"function","z":"aa5d5df0e0c9a36a","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"2ad313d35dec88e5","type":"function","z":"aa5d5df0e0c9a36a","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"edba373df6f972f8","type":"change","z":"aa5d5df0e0c9a36a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["19ec982acaa24b84"]]},{"id":"19ec982acaa24b84","type":"function","z":"aa5d5df0e0c9a36a","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["ac2e5bb404d12618","fd2ace7150a13245"]]},{"id":"7b5f2dc5c644d843","type":"change","z":"aa5d5df0e0c9a36a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["2ad313d35dec88e5"]]},{"id":"ac2e5bb404d12618","type":"function","z":"aa5d5df0e0c9a36a","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"18e718a8e6b67670","type":"change","z":"aa5d5df0e0c9a36a","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["dc3168edc3f85c53"]]},{"id":"dc3168edc3f85c53","type":"function","z":"aa5d5df0e0c9a36a","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["c2bc03eba023e9e2"]]},{"id":"fd2ace7150a13245","type":"function","z":"aa5d5df0e0c9a36a","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"20a0334bca8466ce","type":"change","z":"aa5d5df0e0c9a36a","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["5224066529d5e6e1"]]},{"id":"5224066529d5e6e1","type":"function","z":"aa5d5df0e0c9a36a","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["c2bc03eba023e9e2"]]},{"id":"1d777402d55ae651","type":"function","z":"aa5d5df0e0c9a36a","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["b3d1677d411e0451"]]},{"id":"c2bc03eba023e9e2","type":"join","z":"aa5d5df0e0c9a36a","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["1d777402d55ae651"]]},{"id":"cec73053a4f6b1b2","type":"switch","z":"aa5d5df0e0c9a36a","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"b3d1677d411e0451","type":"function","z":"aa5d5df0e0c9a36a","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["cec73053a4f6b1b2"]]},{"id":"7b9a915a3789e30c","type":"function","z":"3e52703495c2ef6e","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"4ce37a310a2108bf","type":"change","z":"3e52703495c2ef6e","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["35b296623ba67b72"]]},{"id":"a6cacb33b97fda29","type":"function","z":"3e52703495c2ef6e","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"068951705f0c75bc","type":"change","z":"3e52703495c2ef6e","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["6fe1f3799205accb"]]},{"id":"6fe1f3799205accb","type":"function","z":"3e52703495c2ef6e","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["0997b52875e67f38"]]},{"id":"35b296623ba67b72","type":"function","z":"3e52703495c2ef6e","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["a6cacb33b97fda29","b342fc8eeafd82ee"]]},{"id":"b342fc8eeafd82ee","type":"function","z":"3e52703495c2ef6e","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"0937b5c0e8c3948b","type":"change","z":"3e52703495c2ef6e","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["54cfb1930ac629f3"]]},{"id":"54cfb1930ac629f3","type":"function","z":"3e52703495c2ef6e","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["0997b52875e67f38"]]},{"id":"6f860565706f8d51","type":"function","z":"3e52703495c2ef6e","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["1b4da1634734d5b4"]]},{"id":"0997b52875e67f38","type":"join","z":"3e52703495c2ef6e","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["6f860565706f8d51"]]},{"id":"32034a98e3c4ebb8","type":"switch","z":"3e52703495c2ef6e","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"1b4da1634734d5b4","type":"function","z":"3e52703495c2ef6e","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["32034a98e3c4ebb8"]]},{"id":"ba259b3df950a31d","type":"function","z":"143da1d1e758b61a","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"3f77d402edba61af","type":"inject","z":"143da1d1e758b61a","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["ba259b3df950a31d"]]},{"id":"2a374dd7987f81b2","type":"debug","z":"143da1d1e758b61a","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"355986c47ccdae11","type":"change","z":"143da1d1e758b61a","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"c44cab6ea15dc2d4","type":"inject","z":"143da1d1e758b61a","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"d33394adea5181e1","type":"inject","z":"143da1d1e758b61a","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"a80ea6d0f147d657","type":"subflow:3e52703495c2ef6e","z":"143da1d1e758b61a","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"121c18d0a2e378a3","type":"inject","z":"143da1d1e758b61a","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"a31fc23af988d5e2","type":"function","z":"55e6f8a32ae8a43f","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"59f943a0ac48b972","type":"function","z":"55e6f8a32ae8a43f","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"d518f80d2175060d","type":"change","z":"55e6f8a32ae8a43f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["5b65ada91ba65f11"]]},{"id":"5b65ada91ba65f11","type":"function","z":"55e6f8a32ae8a43f","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["7b64ca643ab8ef80","485e56c6446176cb"]]},{"id":"a9bb86415d4a29de","type":"change","z":"55e6f8a32ae8a43f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["59f943a0ac48b972"]]},{"id":"7b64ca643ab8ef80","type":"function","z":"55e6f8a32ae8a43f","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"42835f96eeb6bb6d","type":"change","z":"55e6f8a32ae8a43f","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["39cc36c8666be067"]]},{"id":"39cc36c8666be067","type":"function","z":"55e6f8a32ae8a43f","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["2e9b3b2204bf47b5"]]},{"id":"485e56c6446176cb","type":"function","z":"55e6f8a32ae8a43f","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"de966daa33fe84cd","type":"change","z":"55e6f8a32ae8a43f","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["2296706a12432bb8"]]},{"id":"2296706a12432bb8","type":"function","z":"55e6f8a32ae8a43f","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["2e9b3b2204bf47b5"]]},{"id":"5266adbedb67dfaa","type":"function","z":"55e6f8a32ae8a43f","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["622062d5f9d8aa96"]]},{"id":"2e9b3b2204bf47b5","type":"join","z":"55e6f8a32ae8a43f","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["5266adbedb67dfaa"]]},{"id":"250d2cd60bf3500c","type":"switch","z":"55e6f8a32ae8a43f","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"622062d5f9d8aa96","type":"function","z":"55e6f8a32ae8a43f","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["250d2cd60bf3500c"]]},{"id":"341d489e67c6a489","type":"function","z":"bc9baba03933e320","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"25d2a019989cec1c","type":"change","z":"bc9baba03933e320","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["b158b432f845506c"]]},{"id":"1aaad15f791350e5","type":"function","z":"bc9baba03933e320","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"d1b55028acec7556","type":"change","z":"bc9baba03933e320","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["d2fafc121f454096"]]},{"id":"d2fafc121f454096","type":"function","z":"bc9baba03933e320","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["f64675e64795f954"]]},{"id":"b158b432f845506c","type":"function","z":"bc9baba03933e320","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["1aaad15f791350e5","229c3c898b7172db"]]},{"id":"229c3c898b7172db","type":"function","z":"bc9baba03933e320","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"a277ec7670a5b29d","type":"change","z":"bc9baba03933e320","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["4b5568608be4cba9"]]},{"id":"4b5568608be4cba9","type":"function","z":"bc9baba03933e320","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["f64675e64795f954"]]},{"id":"5951277d209ce076","type":"function","z":"bc9baba03933e320","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["447bdd3bcf4cc91c"]]},{"id":"f64675e64795f954","type":"join","z":"bc9baba03933e320","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["5951277d209ce076"]]},{"id":"61516a36e0fb04bc","type":"switch","z":"bc9baba03933e320","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"447bdd3bcf4cc91c","type":"function","z":"bc9baba03933e320","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["61516a36e0fb04bc"]]},{"id":"88a3cbc7e3a83a02","type":"function","z":"e190c5e0e2fe8b1f","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"5359f28449a5e5ae","type":"inject","z":"e190c5e0e2fe8b1f","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["88a3cbc7e3a83a02"]]},{"id":"d6f51bec09f48989","type":"debug","z":"e190c5e0e2fe8b1f","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"26f2732b77ea298b","type":"change","z":"e190c5e0e2fe8b1f","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"8048ade0ecb0b2f3","type":"inject","z":"e190c5e0e2fe8b1f","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"131acbef1840dd51","type":"inject","z":"e190c5e0e2fe8b1f","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"e3c324670419a876","type":"subflow:bc9baba03933e320","z":"e190c5e0e2fe8b1f","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"b92127e059175671","type":"inject","z":"e190c5e0e2fe8b1f","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"e29cc2971598a000","type":"function","z":"fb0d740ca7477861","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"e4bac6379d1f1801","type":"function","z":"fb0d740ca7477861","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"866f558222d158ed","type":"change","z":"fb0d740ca7477861","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["d5380895738ef841"]]},{"id":"d5380895738ef841","type":"function","z":"fb0d740ca7477861","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["87d21a0dc8767395","c1a973a5d3b84403"]]},{"id":"320d7a1952501a49","type":"change","z":"fb0d740ca7477861","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["e4bac6379d1f1801"]]},{"id":"87d21a0dc8767395","type":"function","z":"fb0d740ca7477861","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"fbf55911f9fa8880","type":"change","z":"fb0d740ca7477861","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["72711acb8fc589e0"]]},{"id":"72711acb8fc589e0","type":"function","z":"fb0d740ca7477861","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["4c77550248222c6f"]]},{"id":"c1a973a5d3b84403","type":"function","z":"fb0d740ca7477861","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"d99021abe9a001f4","type":"change","z":"fb0d740ca7477861","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["f989bc57ea37e31f"]]},{"id":"f989bc57ea37e31f","type":"function","z":"fb0d740ca7477861","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["4c77550248222c6f"]]},{"id":"a0e7ea54e92a909a","type":"function","z":"fb0d740ca7477861","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["1c80b1970cfb789d"]]},{"id":"4c77550248222c6f","type":"join","z":"fb0d740ca7477861","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["a0e7ea54e92a909a"]]},{"id":"706efe3428ac160e","type":"switch","z":"fb0d740ca7477861","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"1c80b1970cfb789d","type":"function","z":"fb0d740ca7477861","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["706efe3428ac160e"]]},{"id":"f85e89fd72c08f91","type":"function","z":"14ccc85c3b36cdc2","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"b3279ecc992925b7","type":"change","z":"14ccc85c3b36cdc2","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["33d52c516ca5680d"]]},{"id":"4f5ad438f32f0991","type":"function","z":"14ccc85c3b36cdc2","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"71879594bd21fbf8","type":"change","z":"14ccc85c3b36cdc2","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["cc506ee62eee14f9"]]},{"id":"cc506ee62eee14f9","type":"function","z":"14ccc85c3b36cdc2","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["8be1abfe6d4f74a4"]]},{"id":"33d52c516ca5680d","type":"function","z":"14ccc85c3b36cdc2","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["4f5ad438f32f0991","e132799e5e67b99a"]]},{"id":"e132799e5e67b99a","type":"function","z":"14ccc85c3b36cdc2","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"bc4fbc3cd1b1dd21","type":"change","z":"14ccc85c3b36cdc2","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["8b88399bcf775116"]]},{"id":"8b88399bcf775116","type":"function","z":"14ccc85c3b36cdc2","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["8be1abfe6d4f74a4"]]},{"id":"630194c72686cc9a","type":"function","z":"14ccc85c3b36cdc2","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["fb2cb4c5d39f5340"]]},{"id":"8be1abfe6d4f74a4","type":"join","z":"14ccc85c3b36cdc2","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["630194c72686cc9a"]]},{"id":"6c91829f58f4b11a","type":"switch","z":"14ccc85c3b36cdc2","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"fb2cb4c5d39f5340","type":"function","z":"14ccc85c3b36cdc2","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["6c91829f58f4b11a"]]},{"id":"c7b7fbb44e8ac02a","type":"function","z":"7b8cb491513bc759","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"8f7be6809359b13c","type":"inject","z":"7b8cb491513bc759","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["c7b7fbb44e8ac02a"]]},{"id":"d1c4853ed77736b2","type":"debug","z":"7b8cb491513bc759","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"d24685c738b4e57e","type":"change","z":"7b8cb491513bc759","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"04af374ab6d85895","type":"inject","z":"7b8cb491513bc759","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"9dc8937e729bcef0","type":"inject","z":"7b8cb491513bc759","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"fc57f51cf61491f7","type":"subflow:14ccc85c3b36cdc2","z":"7b8cb491513bc759","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"c7f734c4c5b72e62","type":"inject","z":"7b8cb491513bc759","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"b739c83e9f517b81","type":"function","z":"06eafb1bf239d14b","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"c75e4373aaedbdea","type":"function","z":"06eafb1bf239d14b","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"8b3dab9076021821","type":"change","z":"06eafb1bf239d14b","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["487fb966f5f8f80a"]]},{"id":"487fb966f5f8f80a","type":"function","z":"06eafb1bf239d14b","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["e9d9288bb3125838","703ebd9b6808fbe1"]]},{"id":"4ccab99b28fd269c","type":"change","z":"06eafb1bf239d14b","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["c75e4373aaedbdea"]]},{"id":"e9d9288bb3125838","type":"function","z":"06eafb1bf239d14b","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"7e1720e43a897aa1","type":"change","z":"06eafb1bf239d14b","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["ddbe598593471d62"]]},{"id":"ddbe598593471d62","type":"function","z":"06eafb1bf239d14b","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["682de776a70e046d"]]},{"id":"703ebd9b6808fbe1","type":"function","z":"06eafb1bf239d14b","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"3a78a7b23dba1510","type":"change","z":"06eafb1bf239d14b","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["d1a163c683cfcd1a"]]},{"id":"d1a163c683cfcd1a","type":"function","z":"06eafb1bf239d14b","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["682de776a70e046d"]]},{"id":"6ff7b88a7050c017","type":"function","z":"06eafb1bf239d14b","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["ca4fa15f20124448"]]},{"id":"682de776a70e046d","type":"join","z":"06eafb1bf239d14b","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["6ff7b88a7050c017"]]},{"id":"53211cf94f1bc1c4","type":"switch","z":"06eafb1bf239d14b","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"ca4fa15f20124448","type":"function","z":"06eafb1bf239d14b","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["53211cf94f1bc1c4"]]},{"id":"2204162ab3c163a2","type":"function","z":"8e930ef98316b18a","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"73739a017b868667","type":"change","z":"8e930ef98316b18a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["71c7f7792b195fbd"]]},{"id":"b14bc8534837c71c","type":"function","z":"8e930ef98316b18a","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"f84a4d29be7ecd22","type":"change","z":"8e930ef98316b18a","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["3a709bab87bd2cf1"]]},{"id":"3a709bab87bd2cf1","type":"function","z":"8e930ef98316b18a","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["01424e41caf6adb1"]]},{"id":"71c7f7792b195fbd","type":"function","z":"8e930ef98316b18a","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["b14bc8534837c71c","4fbc1e1254eb4f98"]]},{"id":"4fbc1e1254eb4f98","type":"function","z":"8e930ef98316b18a","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"5914807a98f1ef48","type":"change","z":"8e930ef98316b18a","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["7d6038e301a97296"]]},{"id":"7d6038e301a97296","type":"function","z":"8e930ef98316b18a","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["01424e41caf6adb1"]]},{"id":"1532e69b6f78bd7d","type":"function","z":"8e930ef98316b18a","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["db42a088fd0626b4"]]},{"id":"01424e41caf6adb1","type":"join","z":"8e930ef98316b18a","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["1532e69b6f78bd7d"]]},{"id":"8d9ae703f31af423","type":"switch","z":"8e930ef98316b18a","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"db42a088fd0626b4","type":"function","z":"8e930ef98316b18a","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["8d9ae703f31af423"]]},{"id":"430d054d915b028f","type":"function","z":"a2b3c04cacba73be","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"ba3ce3138df416e4","type":"inject","z":"a2b3c04cacba73be","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["430d054d915b028f"]]},{"id":"d86e01fa040188a5","type":"debug","z":"a2b3c04cacba73be","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"329bbc559cbdac91","type":"change","z":"a2b3c04cacba73be","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"d3db6727f15b17fb","type":"inject","z":"a2b3c04cacba73be","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"b1492d424f34849b","type":"inject","z":"a2b3c04cacba73be","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"f495262b48df9342","type":"subflow:8e930ef98316b18a","z":"a2b3c04cacba73be","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"3da8700d4cc54203","type":"inject","z":"a2b3c04cacba73be","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"0179ec9d46457985","type":"function","z":"47054b48c745842f","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"0c107c6e77fae60f","type":"function","z":"47054b48c745842f","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"d0c1d9d867c7536c","type":"change","z":"47054b48c745842f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["54074f417913d420"]]},{"id":"54074f417913d420","type":"function","z":"47054b48c745842f","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["d2cd21614e6dfadc","02a167fb845ec927"]]},{"id":"423fc62aace61cbf","type":"change","z":"47054b48c745842f","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["0c107c6e77fae60f"]]},{"id":"d2cd21614e6dfadc","type":"function","z":"47054b48c745842f","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"5c913460f626b724","type":"change","z":"47054b48c745842f","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["e3f2381f6fb2623e"]]},{"id":"e3f2381f6fb2623e","type":"function","z":"47054b48c745842f","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["2dba59458b68cbb9"]]},{"id":"02a167fb845ec927","type":"function","z":"47054b48c745842f","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"9ec71514711a1284","type":"change","z":"47054b48c745842f","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["cea6c3180cab056a"]]},{"id":"cea6c3180cab056a","type":"function","z":"47054b48c745842f","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["2dba59458b68cbb9"]]},{"id":"acae054b7085a25f","type":"function","z":"47054b48c745842f","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["0df6230bfb03b27b"]]},{"id":"2dba59458b68cbb9","type":"join","z":"47054b48c745842f","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["acae054b7085a25f"]]},{"id":"d6e15990941f92ce","type":"switch","z":"47054b48c745842f","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"0df6230bfb03b27b","type":"function","z":"47054b48c745842f","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["d6e15990941f92ce"]]},{"id":"2d8b12e467b24280","type":"function","z":"ca5c8c58f09fc994","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"a3b41e02115185fd","type":"change","z":"ca5c8c58f09fc994","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["b3043e273e13421b"]]},{"id":"010d2942b8084b50","type":"function","z":"ca5c8c58f09fc994","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"e24c787013f7946a","type":"change","z":"ca5c8c58f09fc994","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["fe9e141262de4f1e"]]},{"id":"fe9e141262de4f1e","type":"function","z":"ca5c8c58f09fc994","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["31490f66028d0b24"]]},{"id":"b3043e273e13421b","type":"function","z":"ca5c8c58f09fc994","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["010d2942b8084b50","275b989fca9b8c13"]]},{"id":"275b989fca9b8c13","type":"function","z":"ca5c8c58f09fc994","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"94eb1a4edff886e3","type":"change","z":"ca5c8c58f09fc994","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["92ef4acb0b24fb8b"]]},{"id":"92ef4acb0b24fb8b","type":"function","z":"ca5c8c58f09fc994","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["31490f66028d0b24"]]},{"id":"2d554d0f7dc55e22","type":"function","z":"ca5c8c58f09fc994","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["64097586f6787bc6"]]},{"id":"31490f66028d0b24","type":"join","z":"ca5c8c58f09fc994","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["2d554d0f7dc55e22"]]},{"id":"644adab7b038c5fe","type":"switch","z":"ca5c8c58f09fc994","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"64097586f6787bc6","type":"function","z":"ca5c8c58f09fc994","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["644adab7b038c5fe"]]},{"id":"9844945ab2f56377","type":"function","z":"08956b84de3f9840","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"cafd3ba4a67827ac","type":"inject","z":"08956b84de3f9840","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["9844945ab2f56377"]]},{"id":"1a9522bf14e75489","type":"debug","z":"08956b84de3f9840","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"61214ebb7b2338e2","type":"change","z":"08956b84de3f9840","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"5616c07a41c5539e","type":"inject","z":"08956b84de3f9840","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"505c04432f0449b2","type":"inject","z":"08956b84de3f9840","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"34841a18556a694f","type":"subflow:ca5c8c58f09fc994","z":"08956b84de3f9840","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"35613ca1ee60262e","type":"inject","z":"08956b84de3f9840","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"82c060222b0f98fe","type":"function","z":"c7f909d74e51a5c2","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"be879d5e81187de0","type":"function","z":"c7f909d74e51a5c2","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"53c265ba7cfee21c","type":"change","z":"c7f909d74e51a5c2","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["1ace98d93254c60d"]]},{"id":"1ace98d93254c60d","type":"function","z":"c7f909d74e51a5c2","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["f832839706f13558","faacbffbbb6a50c6"]]},{"id":"bb0603158c13c447","type":"change","z":"c7f909d74e51a5c2","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["be879d5e81187de0"]]},{"id":"f832839706f13558","type":"function","z":"c7f909d74e51a5c2","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"727b7d092cb56e42","type":"change","z":"c7f909d74e51a5c2","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["2752b71893db2dad"]]},{"id":"2752b71893db2dad","type":"function","z":"c7f909d74e51a5c2","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["be864c9057696433"]]},{"id":"faacbffbbb6a50c6","type":"function","z":"c7f909d74e51a5c2","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"746e81f85cf7ee7f","type":"change","z":"c7f909d74e51a5c2","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["9b361b7e6ea8eee7"]]},{"id":"9b361b7e6ea8eee7","type":"function","z":"c7f909d74e51a5c2","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["be864c9057696433"]]},{"id":"b9f3203e3a58a95f","type":"function","z":"c7f909d74e51a5c2","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["9ba7aec5356c8201"]]},{"id":"be864c9057696433","type":"join","z":"c7f909d74e51a5c2","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["b9f3203e3a58a95f"]]},{"id":"db23184aa0d0bc30","type":"switch","z":"c7f909d74e51a5c2","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"9ba7aec5356c8201","type":"function","z":"c7f909d74e51a5c2","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["db23184aa0d0bc30"]]},{"id":"907c7eef2f178ee5","type":"function","z":"5338ce25c222e2fe","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"1056d0b8168a3739","type":"change","z":"5338ce25c222e2fe","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["eeb5d9aeb0534806"]]},{"id":"2397bf708bd9cc1d","type":"function","z":"5338ce25c222e2fe","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"90f14e40e2ec6c2f","type":"change","z":"5338ce25c222e2fe","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["886acbe2cc22ee23"]]},{"id":"886acbe2cc22ee23","type":"function","z":"5338ce25c222e2fe","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["842a32ce3b6f4915"]]},{"id":"eeb5d9aeb0534806","type":"function","z":"5338ce25c222e2fe","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["2397bf708bd9cc1d","8b5ea38f56d6a682"]]},{"id":"8b5ea38f56d6a682","type":"function","z":"5338ce25c222e2fe","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"43c256de1c491d13","type":"change","z":"5338ce25c222e2fe","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["fe0580b770b62a40"]]},{"id":"fe0580b770b62a40","type":"function","z":"5338ce25c222e2fe","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["842a32ce3b6f4915"]]},{"id":"df0935486b4f85cd","type":"function","z":"5338ce25c222e2fe","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["f64532ac6306acfb"]]},{"id":"842a32ce3b6f4915","type":"join","z":"5338ce25c222e2fe","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["df0935486b4f85cd"]]},{"id":"f5c0bab2b6f69e83","type":"switch","z":"5338ce25c222e2fe","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"f64532ac6306acfb","type":"function","z":"5338ce25c222e2fe","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["f5c0bab2b6f69e83"]]},{"id":"ef46750b60175e4d","type":"function","z":"e8f1bceec0096530","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"2e2250589ee38c1e","type":"inject","z":"e8f1bceec0096530","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["ef46750b60175e4d"]]},{"id":"4b21e9bf644126a9","type":"debug","z":"e8f1bceec0096530","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"cdb08519b132e719","type":"change","z":"e8f1bceec0096530","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"cc1c79e2f649c5d8","type":"inject","z":"e8f1bceec0096530","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"58f0564b3f7c6f66","type":"inject","z":"e8f1bceec0096530","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"e4dc3ddf116e0821","type":"subflow:5338ce25c222e2fe","z":"e8f1bceec0096530","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"5ddf3a048594a199","type":"inject","z":"e8f1bceec0096530","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"dd32cef9da5b6688","type":"function","z":"99779fdb10bd0ee2","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"38822a1c91c406cb","type":"function","z":"99779fdb10bd0ee2","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"7313440c4368ca20","type":"change","z":"99779fdb10bd0ee2","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["594aa0a27f0447dc"]]},{"id":"594aa0a27f0447dc","type":"function","z":"99779fdb10bd0ee2","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["b453cfb155d27543","d78c03e3ebdf18d1"]]},{"id":"084b2cd45d9d08f0","type":"change","z":"99779fdb10bd0ee2","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["38822a1c91c406cb"]]},{"id":"b453cfb155d27543","type":"function","z":"99779fdb10bd0ee2","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"908404473ac7da9a","type":"change","z":"99779fdb10bd0ee2","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["de698e8e90478c2b"]]},{"id":"de698e8e90478c2b","type":"function","z":"99779fdb10bd0ee2","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["c584f93479384ee9"]]},{"id":"d78c03e3ebdf18d1","type":"function","z":"99779fdb10bd0ee2","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"833671e125255133","type":"change","z":"99779fdb10bd0ee2","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["7a8777f373907a21"]]},{"id":"7a8777f373907a21","type":"function","z":"99779fdb10bd0ee2","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["c584f93479384ee9"]]},{"id":"4d2de651f7256021","type":"function","z":"99779fdb10bd0ee2","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["f4389bbbcbc29e74"]]},{"id":"c584f93479384ee9","type":"join","z":"99779fdb10bd0ee2","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["4d2de651f7256021"]]},{"id":"d9f82c932e5d0d7b","type":"switch","z":"99779fdb10bd0ee2","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"f4389bbbcbc29e74","type":"function","z":"99779fdb10bd0ee2","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["d9f82c932e5d0d7b"]]},{"id":"2d23ae39ecf2d27e","type":"function","z":"58ac689525e45831","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"9ca04db806b72e88","type":"change","z":"58ac689525e45831","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["972229eaca36f6ef"]]},{"id":"bbf58ba0a69fd923","type":"function","z":"58ac689525e45831","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"cce028e8c957465c","type":"change","z":"58ac689525e45831","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["23ebe2f3e8450d5b"]]},{"id":"23ebe2f3e8450d5b","type":"function","z":"58ac689525e45831","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["35e429ac72a3296f"]]},{"id":"972229eaca36f6ef","type":"function","z":"58ac689525e45831","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["bbf58ba0a69fd923","347e911411a9dbc3"]]},{"id":"347e911411a9dbc3","type":"function","z":"58ac689525e45831","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"ecad30e0e7c9a3da","type":"change","z":"58ac689525e45831","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["da44b22f9076a378"]]},{"id":"da44b22f9076a378","type":"function","z":"58ac689525e45831","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["35e429ac72a3296f"]]},{"id":"29de9c68fe576295","type":"function","z":"58ac689525e45831","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["2ce1b73b9d89e5e7"]]},{"id":"35e429ac72a3296f","type":"join","z":"58ac689525e45831","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["29de9c68fe576295"]]},{"id":"8d93ec6c014873e8","type":"switch","z":"58ac689525e45831","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"2ce1b73b9d89e5e7","type":"function","z":"58ac689525e45831","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["8d93ec6c014873e8"]]},{"id":"7462056da77210b9","type":"function","z":"c7238ca9e13327de","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"ca8df2ba1fd39a91","type":"inject","z":"c7238ca9e13327de","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["7462056da77210b9"]]},{"id":"6f87c3d09c5f9c48","type":"debug","z":"c7238ca9e13327de","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"82e73f0cd27a33a2","type":"change","z":"c7238ca9e13327de","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"9062847d2795cd5a","type":"inject","z":"c7238ca9e13327de","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"3893cb4ffb7b50b1","type":"inject","z":"c7238ca9e13327de","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"4b7c8946bcbc0a5a","type":"subflow:58ac689525e45831","z":"c7238ca9e13327de","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"0809d451d2d768db","type":"inject","z":"c7238ca9e13327de","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"7c5a41795bd58c2e","type":"function","z":"23960be9f58b3aca","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"78ca44d0e7d06e71","type":"function","z":"23960be9f58b3aca","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"4bac020c104aa993","type":"change","z":"23960be9f58b3aca","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["f6329bc60ec9098a"]]},{"id":"f6329bc60ec9098a","type":"function","z":"23960be9f58b3aca","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["880b4cc2c6082ea1","28770e0f4df937c2"]]},{"id":"2d52901d24162f4c","type":"change","z":"23960be9f58b3aca","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["78ca44d0e7d06e71"]]},{"id":"880b4cc2c6082ea1","type":"function","z":"23960be9f58b3aca","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"236e9c58ab91fa5f","type":"change","z":"23960be9f58b3aca","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["85c03e9c189b13e2"]]},{"id":"85c03e9c189b13e2","type":"function","z":"23960be9f58b3aca","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["0e45715afa0a036e"]]},{"id":"28770e0f4df937c2","type":"function","z":"23960be9f58b3aca","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"bb41877eab64cba5","type":"change","z":"23960be9f58b3aca","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["f563e6e785b445ad"]]},{"id":"f563e6e785b445ad","type":"function","z":"23960be9f58b3aca","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["0e45715afa0a036e"]]},{"id":"72c4cfb1a5db9ddc","type":"function","z":"23960be9f58b3aca","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["13ea56073bb19fc3"]]},{"id":"0e45715afa0a036e","type":"join","z":"23960be9f58b3aca","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["72c4cfb1a5db9ddc"]]},{"id":"19fb78fa01e9a3b4","type":"switch","z":"23960be9f58b3aca","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"13ea56073bb19fc3","type":"function","z":"23960be9f58b3aca","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["19fb78fa01e9a3b4"]]},{"id":"6a66eac3f01c6012","type":"function","z":"3da456f25e6d6d22","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"e58645b97de54b82","type":"change","z":"3da456f25e6d6d22","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["1646412788952e71"]]},{"id":"ec74fa7f6489acfd","type":"function","z":"3da456f25e6d6d22","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"cd2b40dbe898d69e","type":"change","z":"3da456f25e6d6d22","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["211a436dd20f0256"]]},{"id":"211a436dd20f0256","type":"function","z":"3da456f25e6d6d22","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["5b82eeaa417ea910"]]},{"id":"1646412788952e71","type":"function","z":"3da456f25e6d6d22","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["ec74fa7f6489acfd","b4f9e43db20991df"]]},{"id":"b4f9e43db20991df","type":"function","z":"3da456f25e6d6d22","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"d5094a470a18c5df","type":"change","z":"3da456f25e6d6d22","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["5175f40696549019"]]},{"id":"5175f40696549019","type":"function","z":"3da456f25e6d6d22","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["5b82eeaa417ea910"]]},{"id":"13ca2edefe89e829","type":"function","z":"3da456f25e6d6d22","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["494ef14e5b90f07b"]]},{"id":"5b82eeaa417ea910","type":"join","z":"3da456f25e6d6d22","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["13ca2edefe89e829"]]},{"id":"1b70592ad1c48f60","type":"switch","z":"3da456f25e6d6d22","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"494ef14e5b90f07b","type":"function","z":"3da456f25e6d6d22","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["1b70592ad1c48f60"]]},{"id":"7ceac77f2ddbf7c7","type":"function","z":"b3f6fa9ec3cfb3bf","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"424caaaac5d7c448","type":"inject","z":"b3f6fa9ec3cfb3bf","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["7ceac77f2ddbf7c7"]]},{"id":"f7d393c050eb9ea9","type":"debug","z":"b3f6fa9ec3cfb3bf","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"34a836143f6c7137","type":"change","z":"b3f6fa9ec3cfb3bf","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"33a1d01246d26800","type":"inject","z":"b3f6fa9ec3cfb3bf","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"a8b9e23c920c758d","type":"inject","z":"b3f6fa9ec3cfb3bf","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"12f7e242dc9c70cb","type":"subflow:3da456f25e6d6d22","z":"b3f6fa9ec3cfb3bf","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"56f2115340b1deea","type":"inject","z":"b3f6fa9ec3cfb3bf","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"96ccd40d0ee49605","type":"function","z":"3af53d1b72d804b3","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"770faa5b640567f2","type":"function","z":"3af53d1b72d804b3","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"e2960606e3ac9a92","type":"change","z":"3af53d1b72d804b3","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["3478b3ae84db29a4"]]},{"id":"3478b3ae84db29a4","type":"function","z":"3af53d1b72d804b3","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["7a7fd769c52ef6e6","64ca1ce8ae350fd5"]]},{"id":"97897526edaf5b80","type":"change","z":"3af53d1b72d804b3","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["770faa5b640567f2"]]},{"id":"7a7fd769c52ef6e6","type":"function","z":"3af53d1b72d804b3","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"90773cb360a8bc89","type":"change","z":"3af53d1b72d804b3","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["eb65d3aa82d9710e"]]},{"id":"eb65d3aa82d9710e","type":"function","z":"3af53d1b72d804b3","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["7f6c3a9a78816498"]]},{"id":"64ca1ce8ae350fd5","type":"function","z":"3af53d1b72d804b3","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"d9080663cce7327b","type":"change","z":"3af53d1b72d804b3","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["b017e31dde5364cc"]]},{"id":"b017e31dde5364cc","type":"function","z":"3af53d1b72d804b3","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["7f6c3a9a78816498"]]},{"id":"6c8063a1a16ac942","type":"function","z":"3af53d1b72d804b3","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["b77b50a3ef5f73a5"]]},{"id":"7f6c3a9a78816498","type":"join","z":"3af53d1b72d804b3","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["6c8063a1a16ac942"]]},{"id":"f07bd469dfaf8d87","type":"switch","z":"3af53d1b72d804b3","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"b77b50a3ef5f73a5","type":"function","z":"3af53d1b72d804b3","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["f07bd469dfaf8d87"]]},{"id":"3fac95f4b96b5b1e","type":"function","z":"b72e495677058f03","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"f7373b03b1812091","type":"change","z":"b72e495677058f03","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["1a6c76dcd23e2257"]]},{"id":"32a188b710cdce55","type":"function","z":"b72e495677058f03","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"f6a60973fc512701","type":"change","z":"b72e495677058f03","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["903dfddb3695fa8e"]]},{"id":"903dfddb3695fa8e","type":"function","z":"b72e495677058f03","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["8c1b571c7ddea9ae"]]},{"id":"1a6c76dcd23e2257","type":"function","z":"b72e495677058f03","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["32a188b710cdce55","fd5fdf1119a5f618"]]},{"id":"fd5fdf1119a5f618","type":"function","z":"b72e495677058f03","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"0671c1860eb693bc","type":"change","z":"b72e495677058f03","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["69e840df6b7dbc21"]]},{"id":"69e840df6b7dbc21","type":"function","z":"b72e495677058f03","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["8c1b571c7ddea9ae"]]},{"id":"9659bf7a1e52975e","type":"function","z":"b72e495677058f03","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["7f2c920669da959d"]]},{"id":"8c1b571c7ddea9ae","type":"join","z":"b72e495677058f03","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["9659bf7a1e52975e"]]},{"id":"86217775131edf7a","type":"switch","z":"b72e495677058f03","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"7f2c920669da959d","type":"function","z":"b72e495677058f03","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["86217775131edf7a"]]},{"id":"89c0530b221bced3","type":"function","z":"e1e1bd53b5ba992f","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"57b5b1e464051698","type":"inject","z":"e1e1bd53b5ba992f","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["89c0530b221bced3"]]},{"id":"1c7e8e1692d9178d","type":"debug","z":"e1e1bd53b5ba992f","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"f982f8f797942191","type":"change","z":"e1e1bd53b5ba992f","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"8afc609c07549480","type":"inject","z":"e1e1bd53b5ba992f","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"86ddaf32a69ed816","type":"inject","z":"e1e1bd53b5ba992f","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"f08ef7ac15c3d76d","type":"subflow:b72e495677058f03","z":"e1e1bd53b5ba992f","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"bc6ca2b4b3407455","type":"inject","z":"e1e1bd53b5ba992f","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"75e8da9920a33caf","type":"function","z":"27060a2b2477c9fb","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"0677f4f5cde29dfa","type":"function","z":"27060a2b2477c9fb","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"098d4c037aa70ced","type":"change","z":"27060a2b2477c9fb","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["deeb9f4048cdd708"]]},{"id":"deeb9f4048cdd708","type":"function","z":"27060a2b2477c9fb","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["1611edfad3db3cd9","77e71b809f51dc13"]]},{"id":"d431ac93900e25c8","type":"change","z":"27060a2b2477c9fb","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["0677f4f5cde29dfa"]]},{"id":"1611edfad3db3cd9","type":"function","z":"27060a2b2477c9fb","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"61176439e9599c34","type":"change","z":"27060a2b2477c9fb","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["322d92778e893494"]]},{"id":"322d92778e893494","type":"function","z":"27060a2b2477c9fb","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["8e4a4a49a5b67bb4"]]},{"id":"77e71b809f51dc13","type":"function","z":"27060a2b2477c9fb","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"317f8e55a672b451","type":"change","z":"27060a2b2477c9fb","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["c6876458bc5932c0"]]},{"id":"c6876458bc5932c0","type":"function","z":"27060a2b2477c9fb","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["8e4a4a49a5b67bb4"]]},{"id":"ecaf3dfd26052d46","type":"function","z":"27060a2b2477c9fb","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["6adddd5ce67fea7c"]]},{"id":"8e4a4a49a5b67bb4","type":"join","z":"27060a2b2477c9fb","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["ecaf3dfd26052d46"]]},{"id":"c3f0375ef8fc8e07","type":"switch","z":"27060a2b2477c9fb","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"6adddd5ce67fea7c","type":"function","z":"27060a2b2477c9fb","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["c3f0375ef8fc8e07"]]},{"id":"f3b6b7d9cb38caa0","type":"function","z":"f8c4a4b5fdbe8bbc","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"d38b056182bdbfbd","type":"change","z":"f8c4a4b5fdbe8bbc","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["2978f6d71ae653c1"]]},{"id":"80d7567d9c9d4974","type":"function","z":"f8c4a4b5fdbe8bbc","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"f67f4ce81dc3477c","type":"change","z":"f8c4a4b5fdbe8bbc","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["826a7053d6d4ffc6"]]},{"id":"826a7053d6d4ffc6","type":"function","z":"f8c4a4b5fdbe8bbc","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["d5655db182aab503"]]},{"id":"2978f6d71ae653c1","type":"function","z":"f8c4a4b5fdbe8bbc","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["80d7567d9c9d4974","c6235bbe8c442a22"]]},{"id":"c6235bbe8c442a22","type":"function","z":"f8c4a4b5fdbe8bbc","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"8a93df59a9cb0299","type":"change","z":"f8c4a4b5fdbe8bbc","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["ce218d687507c6ca"]]},{"id":"ce218d687507c6ca","type":"function","z":"f8c4a4b5fdbe8bbc","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["d5655db182aab503"]]},{"id":"6874f346ed851ff7","type":"function","z":"f8c4a4b5fdbe8bbc","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["bc48e6086d15ab4c"]]},{"id":"d5655db182aab503","type":"join","z":"f8c4a4b5fdbe8bbc","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["6874f346ed851ff7"]]},{"id":"81e2eb0de6d883e0","type":"switch","z":"f8c4a4b5fdbe8bbc","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"bc48e6086d15ab4c","type":"function","z":"f8c4a4b5fdbe8bbc","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["81e2eb0de6d883e0"]]},{"id":"cf63a14e7c8ee7c4","type":"function","z":"79fd9d04e0aa31c8","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"8c916cf850bed979","type":"inject","z":"79fd9d04e0aa31c8","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["cf63a14e7c8ee7c4"]]},{"id":"763f2939f331f2e0","type":"debug","z":"79fd9d04e0aa31c8","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"b398cdfa9af04f9c","type":"change","z":"79fd9d04e0aa31c8","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"b0ec388ca2d1049d","type":"inject","z":"79fd9d04e0aa31c8","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"1105ba2eddd034ef","type":"inject","z":"79fd9d04e0aa31c8","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"bd7a07ee1efd1322","type":"subflow:f8c4a4b5fdbe8bbc","z":"79fd9d04e0aa31c8","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"46ef35db8f0bb66f","type":"inject","z":"79fd9d04e0aa31c8","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"7cfc55eba058f3d2","type":"function","z":"fe49b8da9b7e2783","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"0d2833513b14cfd4","type":"function","z":"fe49b8da9b7e2783","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"9076e2abe69ad5f5","type":"change","z":"fe49b8da9b7e2783","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["03777bcb8c08bd6d"]]},{"id":"03777bcb8c08bd6d","type":"function","z":"fe49b8da9b7e2783","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["98775c7a0e542554","c8bb82f39dfee542"]]},{"id":"f4efb44b875679eb","type":"change","z":"fe49b8da9b7e2783","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["0d2833513b14cfd4"]]},{"id":"98775c7a0e542554","type":"function","z":"fe49b8da9b7e2783","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"f61ca2efafdeaea2","type":"change","z":"fe49b8da9b7e2783","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["3f67eba203555b65"]]},{"id":"3f67eba203555b65","type":"function","z":"fe49b8da9b7e2783","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["8f7f7680fc3705fc"]]},{"id":"c8bb82f39dfee542","type":"function","z":"fe49b8da9b7e2783","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"9f27021915cb9ae9","type":"change","z":"fe49b8da9b7e2783","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["23aa06ebc8532ebb"]]},{"id":"23aa06ebc8532ebb","type":"function","z":"fe49b8da9b7e2783","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["8f7f7680fc3705fc"]]},{"id":"cdbb7b99f134be03","type":"function","z":"fe49b8da9b7e2783","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["4dec219c4572a1ed"]]},{"id":"8f7f7680fc3705fc","type":"join","z":"fe49b8da9b7e2783","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["cdbb7b99f134be03"]]},{"id":"b54bb6aa1bf7467a","type":"switch","z":"fe49b8da9b7e2783","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"4dec219c4572a1ed","type":"function","z":"fe49b8da9b7e2783","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["b54bb6aa1bf7467a"]]},{"id":"5b598e6256abe3de","type":"function","z":"c74804fddfd5949e","name":"CSN from wetrack metadata","func":"msg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= 1 ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":256.9996871948242,"y":100.99999046325684,"wires":[[]]},{"id":"56599b24cfb97a18","type":"change","z":"c74804fddfd5949e","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":666.999755859375,"y":99.99999141693115,"wires":[["5977c7a143bfba9f"]]},{"id":"88ca9772fa856e4c","type":"function","z":"c74804fddfd5949e","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":264.9999885559082,"y":181.99998664855957,"wires":[[]]},{"id":"953bbf15e199da29","type":"change","z":"c74804fddfd5949e","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":689.3336563110352,"y":215.00011157989502,"wires":[["8bfc5d6136921341"]]},{"id":"8bfc5d6136921341","type":"function","z":"c74804fddfd5949e","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":929.9997901916504,"y":180.66669464111328,"wires":[["c8b6d043f1270396"]]},{"id":"5977c7a143bfba9f","type":"function","z":"c74804fddfd5949e","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":852.3333435058594,"y":100.66674613952637,"wires":[["88ca9772fa856e4c","79f3093dbaa33afe"]]},{"id":"79f3093dbaa33afe","type":"function","z":"c74804fddfd5949e","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":295.99976348876953,"y":282.99999713897705,"wires":[[]]},{"id":"114d8bac40e052a0","type":"change","z":"c74804fddfd5949e","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":801.000129699707,"y":283.00011348724365,"wires":[["14e9597bb534ee04"]]},{"id":"14e9597bb534ee04","type":"function","z":"c74804fddfd5949e","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1037.6664962768555,"y":281.6666564941406,"wires":[["c8b6d043f1270396"]]},{"id":"37e989c43e48e2bd","type":"function","z":"c74804fddfd5949e","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1147.333080291748,"y":353,"wires":[["f92b0127ebf84909"]]},{"id":"c8b6d043f1270396","type":"join","z":"c74804fddfd5949e","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":914.6664085388184,"y":352.3334131240845,"wires":[["37e989c43e48e2bd"]]},{"id":"b3cfadadc50a8e37","type":"switch","z":"c74804fddfd5949e","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":949.6667137145996,"y":411.6666717529297,"wires":[[],[]]},{"id":"f92b0127ebf84909","type":"function","z":"c74804fddfd5949e","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":723.6667022705078,"y":413.6666717529297,"wires":[["b3cfadadc50a8e37"]]},{"id":"83836743c36975c8","type":"function","z":"9d3c77214e0380da","name":"","func":"msg.payload = \"abcdefgh\";\nreturn msg;","outputs":1,"noerr":0,"x":599.6667060852051,"y":98.66666793823242,"wires":[[]]},{"id":"3cd5c819676e3cbb","type":"inject","z":"9d3c77214e0380da","name":"Input msg","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":444.3331718444824,"y":99.66676998138428,"wires":[["83836743c36975c8"]]},{"id":"12b905334c7757b3","type":"debug","z":"9d3c77214e0380da","name":"Output 1","active":true,"console":"false","complete":"payload","x":935.3332023620605,"y":237.66667556762695,"wires":[]},{"id":"7c54340ed266e828","type":"change","z":"9d3c77214e0380da","name":"","rules":[{"t":"set","p":"output","pt":"msg","to":"1","tot":"num"},{"t":"set","p":"active","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":585.8370933532715,"y":281.2566108703613,"wires":[[]]},{"id":"22742ca4379cb839","type":"inject","z":"9d3c77214e0380da","name":"Enable output","repeat":"","crontab":"","once":false,"onceDelay":"","topic":"","payload":"true","payloadType":"bool","x":340.33319091796875,"y":224.4637212753296,"wires":[[]]},{"id":"7b1a5b95b0dafa7e","type":"inject","z":"9d3c77214e0380da","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":245.6664924621582,"y":292.66667652130127,"wires":[[]]},{"id":"d3579b011ce11c8a","type":"subflow:c74804fddfd5949e","z":"9d3c77214e0380da","name":"","x":327.66654205322266,"y":361.66668033599854,"wires":[[],[]]},{"id":"b5226055f0c6cc40","type":"inject","z":"9d3c77214e0380da","name":"","repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"FinalWeight","payloadType":"global","x":309.3331604003906,"y":464.33331775665283,"wires":[[]]},{"id":"72142f7ebd3632c9","type":"function","z":"5f5cde7a7d907be0","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":341.70922088623047,"y":61.16665983200073,"wires":[[]]},{"id":"889e6e2d65ce0e3f","type":"function","z":"5f5cde7a7d907be0","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"x":451.66663360595703,"y":133.66665077209473,"wires":[[]]},{"id":"1e055c10b32ec345","type":"change","z":"5f5cde7a7d907be0","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":701.6667022705078,"y":201.66661739349365,"wires":[["e23be2c425c6a6b7"]]},{"id":"e23be2c425c6a6b7","type":"function","z":"5f5cde7a7d907be0","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"x":887.0002899169922,"y":202.33337211608887,"wires":[["4d237b6dbb56a949","afdd814dc0ddd453"]]},{"id":"40e9893c0910bf89","type":"change","z":"5f5cde7a7d907be0","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":751.6666793823242,"y":51.66666793823242,"wires":[["889e6e2d65ce0e3f"]]},{"id":"4d237b6dbb56a949","type":"function","z":"5f5cde7a7d907be0","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"x":237.66663360595703,"y":271.6666507720947,"wires":[[]]},{"id":"a7ec1ef246ff36a2","type":"change","z":"5f5cde7a7d907be0","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":662.000301361084,"y":304.6667757034302,"wires":[["5e769d1e75ab58f8"]]},{"id":"5e769d1e75ab58f8","type":"function","z":"5f5cde7a7d907be0","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":902.6664352416992,"y":270.33335876464844,"wires":[["169ce9aa815f5531"]]},{"id":"afdd814dc0ddd453","type":"function","z":"5f5cde7a7d907be0","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"x":268.66640853881836,"y":372.6666612625122,"wires":[[]]},{"id":"0734bd26b316ac53","type":"change","z":"5f5cde7a7d907be0","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":773.6667747497559,"y":372.6667776107788,"wires":[["1f7a87fa3cf0a8fe"]]},{"id":"1f7a87fa3cf0a8fe","type":"function","z":"5f5cde7a7d907be0","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"x":1010.3331413269043,"y":371.3333206176758,"wires":[["169ce9aa815f5531"]]},{"id":"96a3d375b811c3a9","type":"function","z":"5f5cde7a7d907be0","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"x":1119.9997253417969,"y":442.66666412353516,"wires":[["813175a87e9639c2"]]},{"id":"169ce9aa815f5531","type":"join","z":"5f5cde7a7d907be0","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":887.3330535888672,"y":442.00007724761963,"wires":[["96a3d375b811c3a9"]]},{"id":"dfda36a73de36bd3","type":"switch","z":"5f5cde7a7d907be0","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":922.3333587646484,"y":501.33333587646484,"wires":[[],[]]},{"id":"813175a87e9639c2","type":"function","z":"5f5cde7a7d907be0","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}","outputs":1,"noerr":0,"x":696.3333473205566,"y":503.33333587646484,"wires":[["dfda36a73de36bd3"]]},{"id":"e4e6fafb6738d167","type":"function","z":"ead3ceda12a2434c","name":"B_POS from coil_buffer_pos","func":"msg.payload=\"SELECT \\\"B_POS\\\" FROM public.coil_buffer_pos WHERE \\\"KEY\\\"=99\";\nreturn msg;\n\n\n//get the buffer number for billet","outputs":1,"noerr":0,"x":339.8081817626953,"y":46.24999952316284,"wires":[["7d3da9f1176d254b"]]},{"id":"7d3da9f1176d254b","type":"postgres","z":"ead3ceda12a2434c","postgresdb":"3efadbde.42b454","name":"","output":true,"perrow":false,"rowspermsg":"1","return_on_error":true,"limit_queries":"0","limit_by":"payload","limit_value":"1","limit_drop_intermediate":false,"limit_drop_if_in_queue":false,"outputs":true,"x":566.8359298706055,"y":36.250009536743164,"wires":[["5b3e360db0c84362"]]},{"id":"68cc2aff90c0833f","type":"function","z":"ead3ceda12a2434c","name":"CSN from wetrack metadata","func":"var b = msg.payload;\nvar x = Number(b);\nmsg.topic = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI= '\"+x+\"' ; \"\nvar a = msg.topic;\nreturn msg;\n//get charging cs number from wetrack_metada","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":449.7655944824219,"y":118.74999046325684,"wires":[["6d5b7ead82649091"]]},{"id":"6d5b7ead82649091","type":"mysql","z":"ead3ceda12a2434c","mydb":"d714704c.7c05a","name":"","x":752.4326400756836,"y":99.41663932800293,"wires":[["908f43405f949c76"]]},{"id":"908f43405f949c76","type":"change","z":"ead3ceda12a2434c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].CSN","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":699.7656631469727,"y":186.74995708465576,"wires":[["2d8640f59ed402d0"]]},{"id":"2d8640f59ed402d0","type":"function","z":"ead3ceda12a2434c","name":"CSN global","func":"var a = msg.payload;\nglobal.set('CSN_number', a);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":885.099250793457,"y":187.41671180725098,"wires":[["119ef96f3445a100","d3f8b65b6ef99be4"]]},{"id":"5b3e360db0c84362","type":"change","z":"ead3ceda12a2434c","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].B_POS","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":749.7656402587891,"y":36.75000762939453,"wires":[["68cc2aff90c0833f"]]},{"id":"119ef96f3445a100","type":"function","z":"ead3ceda12a2434c","name":"read weight sum from wetrack","func":"var a = global.get('CSN_number');\nmsg.topic =\"SELECT SUM(BILLET_WEIGHT_KG) FROM jspl_wrm.wetrack WHERE CHARGE_SHEET_NO = '\"+a+\"';\"\nglobal.set(\"weight_sum\", msg.payload[0]);\nreturn msg;\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":235.76559448242188,"y":256.74999046325684,"wires":[["6cba084887065c9b"]]},{"id":"6cba084887065c9b","type":"mysql","z":"ead3ceda12a2434c","mydb":"d714704c.7c05a","name":"csn_status","x":475.09928131103516,"y":300.750150680542,"wires":[["deff9bedac3e464e"]]},{"id":"deff9bedac3e464e","type":"change","z":"ead3ceda12a2434c","name":"weight_sum","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0][\"SUM(BILLET_WEIGHT_KG)\"]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":660.0992622375488,"y":289.7501153945923,"wires":[["61affd158059ac57"]]},{"id":"61affd158059ac57","type":"function","z":"ead3ceda12a2434c","name":"billet weight_total_entered_global","func":"var y=msg.payload//[\"SUM(BILLET_WEIGHT_KG)\"];\nglobal.set('weight_summation', y);   // to store a variable (YourVariable)\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":900.7653961181641,"y":255.41669845581055,"wires":[["7bc87746e52df29e"]]},{"id":"d3f8b65b6ef99be4","type":"function","z":"ead3ceda12a2434c","name":"read weightval and threshold weight from csn_status","func":"//var weight_val=msg.payload[0];\n//var threshold_weight = msg.payload[1];\nvar a = global.get('CSN_number');\nmsg.topic =\"SELECT WeightVal, Maxweight  FROM jspl_wrm.csn_status WHERE CSN= '\"+a+\"';\"\nglobal.set(\"weight_validation\", msg.payload[0]);\nglobal.set(\"weight_th\", msg.payload[1]);\nreturn msg;\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":266.7653694152832,"y":357.7500009536743,"wires":[["33c4d88913104710"]]},{"id":"33c4d88913104710","type":"mysql","z":"ead3ceda12a2434c","mydb":"d714704c.7c05a","name":"csn_status","x":576.7658462524414,"y":357.7499942779541,"wires":[["4e85c58b48fbe624"]]},{"id":"4e85c58b48fbe624","type":"change","z":"ead3ceda12a2434c","name":"weight validation","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0].WeightVal","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":771.7657356262207,"y":357.7501173019409,"wires":[["c0f4813add2d3cc6"]]},{"id":"a393cc1d3199c6dd","type":"switch","z":"ead3ceda12a2434c","name":"final triggering","property":"payload","propertyType":"msg","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":920.4323196411133,"y":486.41667556762695,"wires":[[],[]]},{"id":"f47a4b2d24c75343","type":"function","z":"ead3ceda12a2434c","name":"billet rejection condition","func":"//var x = global.get(\"WEIGHT_REALTIME\");\nvar x = global.get(\"WEIGHT\")\n//var x = global.get(\"FinalWeight\");\nvar y = global.get('balance_weight');\nvar a = global.get('CSN_number');\n//var a = \"SELECT CSN FROM jspl_wrm.wetrack_metadata WHERE PRI=1 \";\n\nif (x<=y){\n    \n    msg.payload = true;\n    //msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n} else {\n   \n    msg.payload = false;// \"billet weight is heigher than balance space\";\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET CompStatBillet = 1 WHERE CSN = '\"+a+\"';\"\n    msg.topic = \"UPDATE jspl_wrm.csn_status SET WeightvalMatch = 1 WHERE CSN = '\"+a+\"';\"\n    return msg;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":694.4323081970215,"y":488.41667556762695,"wires":[["a393cc1d3199c6dd","08808bcb1e4cf3a6"]]},{"id":"7bc87746e52df29e","type":"join","z":"ead3ceda12a2434c","name":"","mode":"custom","build":"object","property":"payload","propertyType":"msg","key":"topic","joiner":"\\n","joinerType":"str","accumulate":false,"timeout":"","count":"2","reduceRight":false,"reduceExp":"","reduceInit":"","reduceInitType":"","reduceFixup":"","x":885.432014465332,"y":427.08341693878174,"wires":[["3aaf4f2534b911b3"]]},{"id":"c0f4813add2d3cc6","type":"function","z":"ead3ceda12a2434c","name":"weight validation_global","func":"var y=msg.payload\nglobal.set('weight_validation', y);\nmsg.payload=y;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1008.4321022033691,"y":356.4166603088379,"wires":[["7bc87746e52df29e"]]},{"id":"3aaf4f2534b911b3","type":"function","z":"ead3ceda12a2434c","name":"Balance weight","func":"var x = global.get('weight_summation');\nvar y = global.get('weight_validation');\nmsg.payload = y-x\nglobal.set('balance_weight', msg.payload)\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":1118.0986862182617,"y":427.75000381469727,"wires":[["f47a4b2d24c75343"]]},{"id":"08808bcb1e4cf3a6","type":"mysql","z":"ead3ceda12a2434c","mydb":"d714704c.7c05a","name":"csn_status","x":794.099006652832,"y":559.0835180282593,"wires":[[]]},{"id":"97c69820b661aa01","type":"GSheet","z":"7a741de298788937","creds":"3241f12276ed7a93","method":"get","action":"","sheet":"1oRd_LXqI2Q93VuUAbBJhtF6hKHS1tL14cQoaIqBvHp8","cells":"temp_data!C20:C20","flatten":true,"name":"","x":338.5,"y":115.95118125,"wires":[["af09b127d66a3a2f"]]},{"id":"651327ed6f34c18f","type":"inject","z":"7a741de298788937","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"","payloadType":"date","x":162.5078125,"y":115.93946075439453,"wires":[[]]},{"id":"54fbe3215efddeba","type":"debug","z":"7a741de298788937","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":551.5039443969727,"y":64.94728374481201,"wires":[]},{"id":"af09b127d66a3a2f","type":"change","z":"7a741de298788937","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload[0]","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":563.5118026733398,"y":116.94337940216064,"wires":[[]]},{"id":"eb3b35d4d77be2b8","type":"debug","z":"7a741de298788937","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":634.7657852172852,"y":299.7500400543213,"wires":[]},{"id":"beaca3e35c386730","type":"GSheet","z":"7a741de298788937","creds":"3241f12276ed7a93","method":"get","action":"","sheet":"1oRd_LXqI2Q93VuUAbBJhtF6hKHS1tL14cQoaIqBvHp8","cells":"full_data","flatten":false,"name":"","x":362.76563262939453,"y":304.75000286102295,"wires":[["eb3b35d4d77be2b8"]]},{"id":"ae08942839ab98b7","type":"function","z":"7a741de298788937","name":"","func":"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":261.5078125,"y":201.947275,"wires":[["beaca3e35c386730"]]},{"id":"09f70988a6fd4849","type":"function","z":"7a741de298788937","name":"","func":"msg.topic = \"INSERT INTO bokaro_databasetest_v1 (meter_id, time_info, voltage, current, frequency) VALUES (1,1,1,1,1); \"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":977.5079002380371,"y":397.94340324401855,"wires":[[]]},{"id":"c3402f585dbbc7f9","type":"inject","z":"7a741de298788937","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":144.50399017333984,"y":589.9395217895508,"wires":[["403a323eb5362d80","c94168a26057dfae","bc8e965d8ea84748"]]},{"id":"403a323eb5362d80","type":"function","z":"7a741de298788937","name":"random v,i,f,dt for meter1","func":"var a = parseFloat((Math.random() * (240 - 220) + 220).toFixed(2));\nvar b = parseFloat((Math.random() * (100 - 90) + 90).toFixed(2));\nvar c = parseInt(Date.now()+ 19800000);\nvar d = parseFloat((Math.random() * (50 - 47) + 47).toFixed(2));\nvar e = parseFloat((Math.random() * (250 - 247) + 247).toFixed(2));\nvar f = parseFloat((Math.random() * (350 - 347) + 347).toFixed(2));\nvar g = parseFloat((Math.random() * (450 - 447) + 447).toFixed(2));\nvar h = parseFloat((Math.random() * (750 - 747) + 747).toFixed(2));\nvar i = parseFloat((Math.random() * (550 - 547) + 547).toFixed(2));\nvar j = parseFloat((Math.random() * (650 - 647) + 647).toFixed(2));\n//msg.topic = \"INSERT INTO bokaro_databasetest_v1 (meter_id, time_info, voltage, current, frequency) VALUES (1,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"'); \"\nmsg.topic = \"UPDATE bokaro_1 SET time_stamp = '\"+c+\"', voltage ='\"+a+\"', current = '\"+b+\"', frequency = '\"+d+\"', total_harmonic_distortion = '\"+e+\"', apparent_energy = '\"+f+\"', power_factor = '\"+g+\"', energy = '\"+h+\"', power = '\"+i+\"', apparent_power = '\"+j+\"'WHERE meter_id = 1; \"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":411.51565170288086,"y":536.9433603286743,"wires":[["8e7a27cb47adc45d"]]},{"id":"cc95d14a88acf70d","type":"debug","z":"7a741de298788937","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"false","statusVal":"","statusType":"auto","x":642.5038795471191,"y":720.9433507919312,"wires":[]},{"id":"b65323d4aefaf2f7","type":"function","z":"7a741de298788937","name":"","func":"msg.payload = parseInt(Date.now());\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":413.5156059265137,"y":720.7499866485596,"wires":[["cc95d14a88acf70d"]]},{"id":"3858689889b979c1","type":"inject","z":"7a741de298788937","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":201.51564025878906,"y":719.7499752044678,"wires":[["b65323d4aefaf2f7"]]},{"id":"17658ff2c5b32777","type":"inject","z":"7a741de298788937","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":163.51560592651367,"y":847.7499866485596,"wires":[["31334f50da549611","3e9c6fede5e4a8b4","602443521db0c5e1"]]},{"id":"31334f50da549611","type":"function","z":"7a741de298788937","name":"0 v,i,f,dt for meter1","func":"var a = 0;\nvar b = 0;\nvar c = 0;\nvar d = 0;\nmsg.topic = \"INSERT INTO bokaro_1 (meter_id, time_stamp, voltage, current, frequency) VALUES (1,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"'); \"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":410.5272674560547,"y":794.7538251876831,"wires":[[]]},{"id":"7e18a3672f182867","type":"mysql","z":"7a741de298788937","mydb":"d714704c.7c05a","name":"","x":670.7772827148438,"y":849.5604581832886,"wires":[[]]},{"id":"3e9c6fede5e4a8b4","type":"function","z":"7a741de298788937","name":"0 v,i,f,dt for meter2","func":"var a = 0;\nvar b = 0;\nvar c = 0;\nvar d = 0;\nmsg.topic = \"INSERT INTO bokaro_1 (meter_id, time_stamp, voltage, current, frequency) VALUES (2,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"'); \"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":412.5156059265137,"y":840.7499866485596,"wires":[[]]},{"id":"602443521db0c5e1","type":"function","z":"7a741de298788937","name":"0 v,i,f,dt for meter3","func":"var a = 0;\nvar b = 0;\nvar c = 0;\nvar d = 0;\nmsg.topic = \"INSERT INTO bokaro_1 (meter_id, time_stamp, voltage, current, frequency) VALUES (3,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"'); \"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":413.5156059265137,"y":887.7499866485596,"wires":[[]]},{"id":"8e7a27cb47adc45d","type":"mysql","z":"7a741de298788937","mydb":"d714704c.7c05a","name":"","x":839.0156745910645,"y":595.7500147819519,"wires":[[]]},{"id":"7cc6ba0b6334a6c8","type":"mindconnect","z":"7a741de298788937","name":"bsl_1","configtype":"SHARED_SECRET","agentconfig":"{\n  \"content\": {\n    \"baseUrl\": \"https://southgate.eu1.mindsphere.io\",\n    \"iat\": \"eyJraWQiOiJrZXktaWQtMSIsInR5cCI6IkpXVCIsImFsZyI6IlJTMjU2In0.eyJpc3MiOiJTQ0kiLCJzdWIiOiJjNmQxODk0YzYwZTc0ZGNiODZmODM1OTRmZmY4ODFiYiIsImF1ZCI6IkFJQU0iLCJpYXQiOjE2NTc2OTMyNzUsIm5iZiI6MTY1NzY5MzI3NSwiZXhwIjoxNjU4Mjk4MDc1LCJqdGkiOiJlZTJhY2FjMS0xNzA0LTRkYWQtOTlmYy1lODNiNDFjYzNjOWUiLCJzY29wZSI6IklBVCIsInRlbiI6Imlpb3R4OWR4IiwidGVuX2N0eCI6Im1haW4tdGVuYW50IiwiY2xpZW50X2NyZWRlbnRpYWxzX3Byb2ZpbGUiOlsiU0hBUkVEX1NFQ1JFVCJdLCJzY2hlbWFzIjpbInVybjpzaWVtZW5zOm1pbmRzcGhlcmU6djEiXX0.LuOCeKNYOOkdF67zbw8CTH-_vg6eZo5fc0HA1AyYcgCtxhnOdUjRQvC7KayFORrTF_G9s3czeuKnjMkoUTBftq3gJE6f_veOTCo6fTmoKXBzYMYHQOG5ldKV9m_1igKOy0xbygJlKg0c3B0jf-ou2I7Ofe1mgH-8K4eNKOmoL8jY6Epvh6OB_gnLUbnm5EbkcI7BG75pyP_ex3whXNTTThMCzsmBN8EpL3_W1VIeKc7Oz9mXXeewua-4FgR0z-25Gynhxq65gpqz0Li7PzwGZeCRKaUI_zEufKYCxizVA_J6gaMexD8bnoslrDOHMN3XVZCrG9dM5YM_QuRGHRhC4w\",\n    \"clientCredentialProfile\": [\n      \"SHARED_SECRET\"\n    ],\n    \"clientId\": \"c6d1894c60e74dcb86f83594fff881bb\",\n    \"tenant\": \"iiotx9dx\"\n  },\n  \"expiration\": \"2022-07-20T06:21:15.000Z\"\n}","privatekey":"","model":"","validate":false,"validateevent":false,"chunk":false,"disablekeepalive":false,"emitcontrol":false,"datalakeonly":false,"supressverbosity":false,"retry":3,"parallel":1,"asyncduration":10,"x":656.5116920471191,"y":1003.2011489868164,"wires":[[]]},{"id":"67924b2c7715ebf7","type":"function","z":"7a741de298788937","name":"random v,i,f,dt for meter1","func":"var a = parseFloat((Math.random() * (240 - 220) + 220).toFixed(2));\n//var b = parseFloat((Math.random() * (100 - 90) + 90).toFixed(2));\n//var c = parseInt(Date.now()+ 19800000);\n//var d = parseFloat((Math.random() * (50 - 47) + 47).toFixed(2));\n\n// take a look at the flow examples at https://playground.mindconnect.rocks\n//\n// - MindSphere expects all values to be encoded as strings\n// - Integers must not have any decimal places\n// - It is a good practice to use javascript literal notation\n// \n// * Examples: \n// \n//   - Random value between 0 and 100: `${Math.random()*100}` \n//   - Variable (HUMIDITY) from input node : `${msg.payload.HUMIDITY}` \n//   - Variable (SPEED) from input node with 0 as default: `${msg.payload.SPEED || 0}`\n\nconst values = [\n  {\n    \"dataPointId\": \"1655986441636\",\n    \"qualityCode\": \"1\",\n    \"value\":\"parseFloat((Math.random() * (240 - 220) + 220).toFixed(2))\"\n  }\n];\nmsg._time = new Date();\nmsg.payload=values;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":418.76565170288086,"y":944.9999952316284,"wires":[[]]},{"id":"bb0b2b3b91e39b77","type":"inject","z":"7a741de298788937","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":207.76560592651367,"y":1007.9999866485596,"wires":[["68b69fea89c99456"]]},{"id":"dac2d0c9b3512f28","type":"debug","z":"7a741de298788937","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":689.8788871765137,"y":1079.8613241485596,"wires":[]},{"id":"68b69fea89c99456","type":"function","z":"7a741de298788937","name":"","func":"\n// take a look at the flow examples at https://playground.mindconnect.rocks\n//\n// - MindSphere expects all values to be encoded as strings\n// - Integers must not have any decimal places\n// - It is a good practice to use javascript literal notation\n// \n// * Examples: \n// \n//   - Random value between 0 and 100: `${Math.random()*100}` \n//   - Variable (HUMIDITY) from input node : `${msg.payload.HUMIDITY}` \n//   - Variable (SPEED) from input node with 0 as default: `${msg.payload.SPEED || 0}`\n\nconst values = [\n  {\n    \"dataPointId\": \"DP-Voltage\",\n    \"qualityCode\": \"0\",\n    \"value\": `${Math.random() * (250 - 220) + 220}`\n  },\n  {\n    \"dataPointId\": \"DP-Total_harmonic_distortion\",\n    \"qualityCode\": \"0\",\n    \"value\": `${Math.random() * (1 - 0) + 0}`\n  },\n  {\n    \"dataPointId\": \"DP-Power\",\n    \"qualityCode\": \"0\",\n    \"value\": `${Math.random() * (50 - 48) + 48}`\n  },\n  {\n    \"dataPointId\": \"DP-Energy\",\n    \"qualityCode\": \"0\",\n    \"value\": `${Math.random() * (150 - 100) + 100}`\n  },\n  {\n    \"dataPointId\": \"DP-Current\",\n    \"qualityCode\": \"0\",\n    \"value\": `${Math.random() * (500 - 480) + 480}`\n  },\n  {\n    \"dataPointId\": \"DP-Apparent_power\",\n    \"qualityCode\": \"0\",\n    \"value\": `${Math.random() * (80 - 75) + 75}`\n  }\n];\nmsg._time = new Date();\nmsg.payload=values;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":426.50004959106445,"y":1061.2011489868164,"wires":[["dac2d0c9b3512f28","7cc6ba0b6334a6c8"]]},{"id":"4d196e880c0bfb5c","type":"mindconnect","z":"7a741de298788937","name":"bsl_2","configtype":"SHARED_SECRET","agentconfig":"{\n  \"content\": {\n    \"baseUrl\": \"https://southgate.eu1.mindsphere.io\",\n    \"iat\": \"eyJraWQiOiJrZXktaWQtMSIsInR5cCI6IkpXVCIsImFsZyI6IlJTMjU2In0.eyJpc3MiOiJTQ0kiLCJzdWIiOiI4YzRhOTZkNDc4Yjg0YjZjYWE5MDcwOGEyNjg4ZTlkZCIsImF1ZCI6IkFJQU0iLCJpYXQiOjE2NTc2Mjg5NTEsIm5iZiI6MTY1NzYyODk1MSwiZXhwIjoxNjU4MjMzNzUxLCJqdGkiOiJkMDY4M2E1Ni1lYzI1LTQ2MTQtOTgxMy0wNDQ2MTUxODQwMzEiLCJzY29wZSI6IklBVCIsInRlbiI6Imlpb3R4OWR4IiwidGVuX2N0eCI6Im1haW4tdGVuYW50IiwiY2xpZW50X2NyZWRlbnRpYWxzX3Byb2ZpbGUiOlsiU0hBUkVEX1NFQ1JFVCJdLCJzY2hlbWFzIjpbInVybjpzaWVtZW5zOm1pbmRzcGhlcmU6djEiXX0.HgrwlEvxqbsuhH8bJfzr7Per70GLrVmTVdbGm7yKlBtC-C54RgrV6NryDAYCjD6RHsLmckxQC63ezZHgPcAMRZLpjVvcKaKfGhvU06Uf6W2VfCGWIkuH85YPxZ6Jhrrdr6M_cKDQqiEugPonhoUKSyhSH4KKTc8Tb0x9zX4qLfanqCEnvzR32NgacaQjFdRqSYrqUaqa-hyo5-ocNJ2xQxqKEFMCOYlr46EECZwCGtkLGdgGB4mWlgPkz1Pu94buBoUhRIDo399-4NxKSFlFbdL696jCFnUAc_Qs5r_7yy_OBwmMFwmtjx-4m93LGRZ2xacG0XNxPy-tFW4ejqoJQg\",\n    \"clientCredentialProfile\": [\n      \"SHARED_SECRET\"\n    ],\n    \"clientId\": \"8c4a96d478b84b6caa90708a2688e9dd\",\n    \"tenant\": \"iiotx9dx\"\n  },\n  \"expiration\": \"2022-07-19T12:29:11.000Z\"\n}","privatekey":"","model":"","validate":false,"validateevent":false,"chunk":false,"disablekeepalive":false,"emitcontrol":false,"datalakeonly":false,"supressverbosity":false,"retry":3,"parallel":1,"asyncduration":10,"x":630.2656059265137,"y":1150.7499866485596,"wires":[[]]},{"id":"2672313d2e36f132","type":"inject","z":"7a741de298788937","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":181.5195198059082,"y":1155.5488243103027,"wires":[["24c661c9860333e3"]]},{"id":"24c661c9860333e3","type":"function","z":"7a741de298788937","name":"","func":"\n// take a look at the flow examples at https://playground.mindconnect.rocks\n//\n// - MindSphere expects all values to be encoded as strings\n// - Integers must not have any decimal places\n// - It is a good practice to use javascript literal notation\n// \n// * Examples: \n// \n//   - Random value between 0 and 100: `${Math.random()*100}` \n//   - Variable (HUMIDITY) from input node : `${msg.payload.HUMIDITY}` \n//   - Variable (SPEED) from input node with 0 as default: `${msg.payload.SPEED || 0}`\n\nconst values = [\n  {\n    \"dataPointId\": \"DP-Voltage\",\n    \"qualityCode\": \"0\",\n    \"value\": `${Math.random() * (250 - 220) + 220}`\n  },\n  {\n    \"dataPointId\": \"DP-Total_harmonic_distortion\",\n    \"qualityCode\": \"0\",\n    \"value\": `${Math.random() * (1 - 0) + 0}`\n  },\n  {\n    \"dataPointId\": \"DP-Power\",\n    \"qualityCode\": \"0\",\n    \"value\": `${Math.random() * (50 - 48) + 48}`\n  },\n  {\n    \"dataPointId\": \"DP-Energy\",\n    \"qualityCode\": \"0\",\n    \"value\": `${Math.random() * (150 - 100) + 100}`\n  },\n  {\n    \"dataPointId\": \"DP-Current\",\n    \"qualityCode\": \"0\",\n    \"value\": `${Math.random() * (500 - 480) + 480}`\n  },\n  {\n    \"dataPointId\": \"DP-Apparent_power\",\n    \"qualityCode\": \"0\",\n    \"value\": `${Math.random() * (80 - 75) + 75}`\n  }\n];\nmsg._time = new Date();\nmsg.payload=values;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":400.253963470459,"y":1208.7499866485596,"wires":[["4d196e880c0bfb5c","63e7e551dc4cbe85"]]},{"id":"63e7e551dc4cbe85","type":"debug","z":"7a741de298788937","name":"","active":false,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":651.2656059265137,"y":1224.7499866485596,"wires":[]},{"id":"d79ef27ac08f1747","type":"inject","z":"7a741de298788937","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":125.66666793823242,"y":1390.333360671997,"wires":[["e3b17ebf756d3596","aa0596c0972cb849","c95d4666ef851b55"]]},{"id":"e3b17ebf756d3596","type":"function","z":"7a741de298788937","name":"0 v,i,f,dt for meter1","func":"var a = 0;\nvar b = 0;\nvar c = 0;\nvar d = 0;\nvar e = 0;\nvar f = 0;\nvar g = 0;\nvar h = 0;\nvar i = 0;\nvar j = 0;\nmsg.payload = {\"action\": \"I\",\"query\": \"INSERT INTO dbo.bokaro_1 (meterID, time_stamp, voltage, current_bsl, frequency, total_harmonic_distortion, apparent_energy, power_factor, energy, power_bsl, apparent_power) VALUES (1,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"', '\"+e+\"','\"+f+\"','\"+g+\"','\"+h+\"','\"+i+\"','\"+j+\"' )\"};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":372.67832946777344,"y":1337.3371992111206,"wires":[[]]},{"id":"c95d4666ef851b55","type":"function","z":"7a741de298788937","name":"0 v,i,f,dt for meter2","func":"var a = 0;\nvar b = 0;\nvar c = 0;\nvar d = 0;\nvar e = 0;\nvar f = 0;\nvar g = 0;\nvar h = 0;\nvar i = 0;\nvar j = 0;\nmsg.payload = {\"action\": \"I\",\"query\": \"INSERT INTO dbo.bokaro_1 (meterID, time_stamp, voltage, current_bsl, frequency, total_harmonic_distortion, apparent_energy, power_factor, energy, power_bsl, apparent_power) VALUES (4,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"', '\"+e+\"','\"+f+\"','\"+g+\"','\"+h+\"','\"+i+\"','\"+j+\"' )\"};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":374.6666679382324,"y":1383.333360671997,"wires":[[]]},{"id":"aa0596c0972cb849","type":"function","z":"7a741de298788937","name":"0 v,i,f,dt for meter3","func":"var a = 0;\nvar b = 0;\nvar c = 0;\nvar d = 0;\nvar e = 0;\nvar f = 0;\nvar g = 0;\nvar h = 0;\nvar i = 0;\nvar j = 0;\nmsg.payload = {\"action\": \"I\",\"query\": \"INSERT INTO dbo.bokaro_1 (meterID, time_stamp, voltage, current_bsl, frequency, total_harmonic_distortion, apparent_energy, power_factor, energy, power_bsl, apparent_power) VALUES (5,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"', '\"+e+\"','\"+f+\"','\"+g+\"','\"+h+\"','\"+i+\"','\"+j+\"' )\"};\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":375.6666679382324,"y":1430.333360671997,"wires":[[]]},{"id":"4c1ad1b64f212f29","type":"debug","z":"7a741de298788937","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"payload","targetType":"msg","statusVal":"","statusType":"auto","x":1006.6666717529297,"y":1331.6667346954346,"wires":[]},{"id":"c94168a26057dfae","type":"function","z":"7a741de298788937","name":"random v,i,f,dt for meter1","func":"var a = parseFloat((Math.random() * (240 - 220) + 220).toFixed(2));\nvar b = parseFloat((Math.random() * (100 - 90) + 90).toFixed(2));\nvar c = parseInt(Date.now()+ 19800000);\nvar d = parseFloat((Math.random() * (50 - 47) + 47).toFixed(2));\nvar e = parseFloat((Math.random() * (150 - 147) + 147).toFixed(2));\nvar f = parseFloat((Math.random() * (650 - 647) + 647).toFixed(2));\nvar g = parseFloat((Math.random() * (250 - 247) + 247).toFixed(2));\nvar h = parseFloat((Math.random() * (550 - 547) + 547).toFixed(2));\nvar i = parseFloat((Math.random() * (350 - 347) + 347).toFixed(2));\nvar j = parseFloat((Math.random() * (450 - 447) + 447).toFixed(2));\n//msg.topic = \"INSERT INTO bokaro_databasetest_v1 (meter_id, time_info, voltage, current, frequency) VALUES (1,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"'); \"\nmsg.topic = \"UPDATE bokaro_1 SET time_stamp = '\"+c+\"', voltage ='\"+a+\"', current = '\"+b+\"', frequency = '\"+d+\"', total_harmonic_distortion = '\"+e+\"', apparent_energy = '\"+f+\"', power_factor = '\"+g+\"', energy = '\"+h+\"', power = '\"+i+\"', apparent_power = '\"+j+\"'WHERE meter_id = 2; \"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":411.9999809265137,"y":579.9999866485596,"wires":[["8e7a27cb47adc45d"]]},{"id":"bc8e965d8ea84748","type":"function","z":"7a741de298788937","name":"random v,i,f,dt for meter1","func":"var a = parseFloat((Math.random() * (240 - 220) + 220).toFixed(2));\nvar b = parseFloat((Math.random() * (100 - 90) + 90).toFixed(2));\nvar c = parseInt(Date.now()+ 19800000);\nvar d = parseFloat((Math.random() * (50 - 47) + 47).toFixed(2));\nvar e = parseFloat((Math.random() * (650 - 647) + 647).toFixed(2));\nvar f = parseFloat((Math.random() * (550 - 547) + 547).toFixed(2));\nvar g = parseFloat((Math.random() * (450 - 447) + 447).toFixed(2));\nvar h = parseFloat((Math.random() * (350 - 347) + 347).toFixed(2));\nvar i = parseFloat((Math.random() * (250 - 247) + 247).toFixed(2));\nvar j = parseFloat((Math.random() * (150 - 147) + 147).toFixed(2));\n//msg.topic = \"INSERT INTO bokaro_databasetest_v1 (meter_id, time_info, voltage, current, frequency) VALUES (1,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"'); \"\nmsg.topic = \"UPDATE bokaro_1 SET time_stamp = '\"+c+\"', voltage ='\"+a+\"', current = '\"+b+\"', frequency = '\"+d+\"', total_harmonic_distortion = '\"+e+\"', apparent_energy = '\"+f+\"', power_factor = '\"+g+\"', energy = '\"+h+\"', power = '\"+i+\"', apparent_power = '\"+j+\"'WHERE meter_id = 3; \"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":415.9999809265137,"y":627.9999866485596,"wires":[["8e7a27cb47adc45d"]]},{"id":"061d79a00c38c2c6","type":"comment","z":"7a741de298788937","name":"shibnath's database","info":"","x":187.765625,"y":1644.621072769165,"wires":[]},{"id":"351108c9ee886c00","type":"inject","z":"7a741de298788937","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":202.20703125,"y":1771.25,"wires":[["a9852fe6363c0b43","51d0865479434129","d7461c7c17d235e9"]]},{"id":"a9852fe6363c0b43","type":"function","z":"7a741de298788937","name":"0 v,i,f,dt for meter1","func":"var a = 0;\nvar b = 0;\nvar c = 0;\nvar d = 0;\nmsg.topic = \"INSERT INTO bokaro_1 (meter_id, time_stamp, voltage, current, frequency) VALUES (1,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"'); \"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":449.218692779541,"y":1718.2538385391235,"wires":[[]]},{"id":"51d0865479434129","type":"function","z":"7a741de298788937","name":"0 v,i,f,dt for meter2","func":"var a = 0;\nvar b = 0;\nvar c = 0;\nvar d = 0;\nmsg.topic = \"INSERT INTO bokaro_1 (meter_id, time_stamp, voltage, current, frequency) VALUES (2,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"'); \"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":451.20703125,"y":1764.25,"wires":[[]]},{"id":"d7461c7c17d235e9","type":"function","z":"7a741de298788937","name":"0 v,i,f,dt for meter3","func":"var a = 0;\nvar b = 0;\nvar c = 0;\nvar d = 0;\nmsg.topic = \"INSERT INTO bokaro_1 (meter_id, time_stamp, voltage, current, frequency) VALUES (3,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"'); \"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":452.20703125,"y":1811.25,"wires":[[]]},{"id":"4ea6194d0b71bf12","type":"inject","z":"7a741de298788937","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"3","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":133.45703125,"y":1968.75,"wires":[["76381e1bd948ce97","44a199dae4c51b47","ba3b2f56adc88d95"]]},{"id":"76381e1bd948ce97","type":"function","z":"7a741de298788937","name":"random v,i,f,dt for meter1","func":"var a = parseFloat((Math.random() * (240 - 220) + 220).toFixed(2));\nvar b = parseFloat((Math.random() * (100 - 90) + 90).toFixed(2));\nvar c = parseInt(Date.now()+ 19800000);\nvar d = parseFloat((Math.random() * (50 - 47) + 47).toFixed(2));\nvar e = parseFloat((Math.random() * (250 - 247) + 247).toFixed(2));\nvar f = parseFloat((Math.random() * (350 - 347) + 347).toFixed(2));\nvar g = parseFloat((Math.random() * (450 - 447) + 447).toFixed(2));\nvar h = parseFloat((Math.random() * (750 - 747) + 747).toFixed(2));\nvar i = parseFloat((Math.random() * (550 - 547) + 547).toFixed(2));\nvar j = parseFloat((Math.random() * (650 - 647) + 647).toFixed(2));\n//msg.topic = \"INSERT INTO bokaro_databasetest_v1 (meter_id, time_info, voltage, current, frequency) VALUES (1,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"'); \"\nmsg.topic = \"UPDATE bokaro_1 SET time_stamp = '\"+c+\"', voltage ='\"+a+\"', current = '\"+b+\"', frequency = '\"+d+\"', total_harmonic_distortion = '\"+e+\"', apparent_energy = '\"+f+\"', power_factor = '\"+g+\"', energy = '\"+h+\"', power = '\"+i+\"', apparent_power = '\"+j+\"' WHERE meterID = 1; \"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":400.468692779541,"y":1915.7538385391235,"wires":[["dd29973168cf679a"]]},{"id":"44a199dae4c51b47","type":"function","z":"7a741de298788937","name":"random v,i,f,dt for meter2","func":"var a = parseFloat((Math.random() * (240 - 220) + 220).toFixed(2));\nvar b = parseFloat((Math.random() * (100 - 90) + 90).toFixed(2));\nvar c = parseInt(Date.now()+ 19800000);\nvar d = parseFloat((Math.random() * (50 - 47) + 47).toFixed(2));\nvar e = parseFloat((Math.random() * (150 - 147) + 147).toFixed(2));\nvar f = parseFloat((Math.random() * (650 - 647) + 647).toFixed(2));\nvar g = parseFloat((Math.random() * (250 - 247) + 247).toFixed(2));\nvar h = parseFloat((Math.random() * (550 - 547) + 547).toFixed(2));\nvar i = parseFloat((Math.random() * (350 - 347) + 347).toFixed(2));\nvar j = parseFloat((Math.random() * (450 - 447) + 447).toFixed(2));\n//msg.topic = \"INSERT INTO bokaro_databasetest_v1 (meter_id, time_info, voltage, current, frequency) VALUES (1,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"'); \"\nmsg.topic = \"UPDATE bokaro_1 SET time_stamp = '\"+c+\"', voltage ='\"+a+\"', current = '\"+b+\"', frequency = '\"+d+\"', total_harmonic_distortion = '\"+e+\"', apparent_energy = '\"+f+\"', power_factor = '\"+g+\"', energy = '\"+h+\"', power = '\"+i+\"', apparent_power = '\"+j+\"'WHERE meterID = 2; \"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":400.9530220031738,"y":1958.8104648590088,"wires":[["dd29973168cf679a"]]},{"id":"ba3b2f56adc88d95","type":"function","z":"7a741de298788937","name":"random v,i,f,dt for meter3","func":"var a = parseFloat((Math.random() * (240 - 220) + 220).toFixed(2));\nvar b = parseFloat((Math.random() * (100 - 90) + 90).toFixed(2));\nvar c = parseInt(Date.now()+ 19800000);\nvar d = parseFloat((Math.random() * (50 - 47) + 47).toFixed(2));\nvar e = parseFloat((Math.random() * (650 - 647) + 647).toFixed(2));\nvar f = parseFloat((Math.random() * (550 - 547) + 547).toFixed(2));\nvar g = parseFloat((Math.random() * (450 - 447) + 447).toFixed(2));\nvar h = parseFloat((Math.random() * (350 - 347) + 347).toFixed(2));\nvar i = parseFloat((Math.random() * (250 - 247) + 247).toFixed(2));\nvar j = parseFloat((Math.random() * (150 - 147) + 147).toFixed(2));\n//msg.topic = \"INSERT INTO bokaro_databasetest_v1 (meter_id, time_info, voltage, current, frequency) VALUES (1,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"'); \"\nmsg.topic = \"UPDATE bokaro_1 SET time_stamp = '\"+c+\"', voltage ='\"+a+\"', current = '\"+b+\"', frequency = '\"+d+\"', total_harmonic_distortion = '\"+e+\"', apparent_energy = '\"+f+\"', power_factor = '\"+g+\"', energy = '\"+h+\"', power = '\"+i+\"', apparent_power = '\"+j+\"'WHERE meterID = 3; \"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":404.9530220031738,"y":2006.8104648590088,"wires":[["dd29973168cf679a"]]},{"id":"38cb09c263c92c61","type":"tedious","z":"7a741de298788937","connection":"f310dbc6faf62152","name":"tedious","x":658.5039024353027,"y":1507.9435291290283,"wires":[[]]},{"id":"0205c0adc265e8a9","type":"function","z":"7a741de298788937","name":"0 v,i,f,dt for meter1","func":"var a = 0;\nvar b = 0;\nvar c = 0;\nvar d = 0;\nmsg.topic = \"INSERT INTO bokaro_1 (meterID) VALUES (1); \"\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":688.7656326293945,"y":1576.7500200271606,"wires":[[]]},{"id":"33f9f2df48f354d9","type":"inject","z":"7a741de298788937","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":472.7539863586426,"y":1576.7462348937988,"wires":[["0205c0adc265e8a9"]]},{"id":"dd29973168cf679a","type":"mysql","z":"7a741de298788937","mydb":"f5fe75e7fa835080","name":"","x":748.7656707763672,"y":1970.250023841858,"wires":[[]]},{"id":"5cff54aa1daca96e","type":"inject","z":"7a741de298788937","name":"","props":[{"p":"payload"},{"p":"topic","vt":"str"}],"repeat":"","crontab":"","once":false,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":125.76561737060547,"y":2128.250023841858,"wires":[["410217c8ba80bf4a","0535a2cfc65043a5","302d29bcd4e550c2"]]},{"id":"410217c8ba80bf4a","type":"function","z":"7a741de298788937","name":"0 v,i,f,dt for meter1","func":"var a = 0;\nvar b = 0;\nvar c = 0;\nvar d = 0;\nvar e = 0;\nvar f = 0;\nvar g = 0;\nvar h = 0;\nvar i = 0;\nvar j = 0;\nmsg.topic = \"INSERT INTO bokaro_1 (meterID, time_stamp, voltage, current, frequency, total_harmonic_distortion, apparent_energy, power_factor, energy, power, apparent_power) VALUES (1,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"', '\"+e+\"','\"+f+\"','\"+g+\"','\"+h+\"','\"+i+\"','\"+j+\"' )\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":388.777286529541,"y":2088.2538385391235,"wires":[["9a4825b7b987d6ca"]]},{"id":"9a4825b7b987d6ca","type":"mysql","z":"7a741de298788937","mydb":"f5fe75e7fa835080","name":"","x":682.765625,"y":2127.25,"wires":[[]]},{"id":"0535a2cfc65043a5","type":"function","z":"7a741de298788937","name":"0 v,i,f,dt for meter2","func":"var a = 0;\nvar b = 0;\nvar c = 0;\nvar d = 0;\nvar e = 0;\nvar f = 0;\nvar g = 0;\nvar h = 0;\nvar i = 0;\nvar j = 0;\nmsg.topic = \"INSERT INTO bokaro_1 (meterID, time_stamp, voltage, current, frequency, total_harmonic_distortion, apparent_energy, power_factor, energy, power, apparent_power) VALUES (2,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"', '\"+e+\"','\"+f+\"','\"+g+\"','\"+h+\"','\"+i+\"','\"+j+\"' )\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":389.765625,"y":2132.25,"wires":[["9a4825b7b987d6ca"]]},{"id":"302d29bcd4e550c2","type":"function","z":"7a741de298788937","name":"0 v,i,f,dt for meter3","func":"var a = 0;\nvar b = 0;\nvar c = 0;\nvar d = 0;\nvar e = 0;\nvar f = 0;\nvar g = 0;\nvar h = 0;\nvar i = 0;\nvar j = 0;\nmsg.topic = \"INSERT INTO bokaro_1 (meterID, time_stamp, voltage, current, frequency, total_harmonic_distortion, apparent_energy, power_factor, energy, power, apparent_power) VALUES (3,'\"+c+\"','\"+a+\"','\"+b+\"','\"+d+\"', '\"+e+\"','\"+f+\"','\"+g+\"','\"+h+\"','\"+i+\"','\"+j+\"' )\";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":388.76564025878906,"y":2180.2500553131104,"wires":[["9a4825b7b987d6ca"]]}]